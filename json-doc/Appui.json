{
    "doc": {
        "description": "",
        "tags": []
    },
    "name": "bbn\\Appui",
    "namespace": true,
    "traits": [],
    "interfaces": [],
    "fileName": "\/home\/thomas\/domains\/apstapp.thomas.lan\/_appui\/vendor\/bbn\/bbn\/src\/bbn\/Appui.php",
    "startLine": 5,
    "endLine": 376,
    "contentConstructor": {
        "file": "bbn\\Appui",
        "returns": null
    },
    "methods": {
        "__construct": {
            "name": "__construct",
            "summary": "Constructor",
            "description": "",
            "description_parts": [],
            "file": "bbn\\Appui",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    $ok = true;\n    foreach (self::$vars as $v) {\n      if (!defined('BBN_'.strtoupper($v))) {\n        X::log(X::_(\"$v is not defined\"));\n        throw new \\Exception(X::_(\"$v is not defined\"));\n        $ok = false;\n      }\n    }\n\n    if ($ok) {\n      $this->_checked = true;\n    }\n  }",
            "startLine": 52,
            "endLine": 66,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "check": {
            "name": "check",
            "summary": "Checks just once whether or not all needed constant have been defined.",
            "description": "",
            "description_parts": [],
            "file": "bbn\\Appui",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return $this->_checked;\n  }",
            "startLine": 74,
            "endLine": 77,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": []
        },
        "getSettings": {
            "name": "getSettings",
            "summary": "Gets the settings of the current project.",
            "description": "",
            "description_parts": [],
            "file": "bbn\\Appui",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    if ($this->check()) {\n      if (empty($this->_settings)\n          && ($file = $this->getSettingsFile())\n          && ($content = file_get_contents($file))\n      ) {\n        if (substr($file, -4) === '.yml') {\n          $this->_settings = yaml_parse($content);\n        }\n        else {\n          $this->_settings = json_decode($content, true);\n        }\n      }\n\n      return $this->_settings;\n    }\n\n    return null;\n  }",
            "startLine": 85,
            "endLine": 104,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                "array",
                null
            ],
            "parent": false,
            "arguments": []
        },
        "getEnvironmentIndex": {
            "name": "getEnvironmentIndex",
            "summary": "Gets the index for the given environment.",
            "description": "",
            "description_parts": [],
            "file": "bbn\\Appui",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($hostname = NULL, $servname = NULL)\n  {\n    if ($this->check()) {\n      if (empty($hostname) && empty($servname)) {\n        $hostname = BBN_HOSTNAME;\n        $servname = BBN_SERVER_NAME;\n      }\n\n      return md5($hostname.$servname);\n    }\n\n    return null;\n\n  }",
            "startLine": 115,
            "endLine": 128,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 0,
            "returns": [
                "string",
                null
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "hostname",
                    "position": 0,
                    "type": "string",
                    "required": false,
                    "has_default": true,
                    "default": null,
                    "default_name": "",
                    "description": "The URL of the environment."
                },
                {
                    "name": "servname",
                    "position": 1,
                    "type": "string",
                    "required": false,
                    "has_default": true,
                    "default": null,
                    "default_name": ""
                }
            ]
        },
        "getEnvironment": {
            "name": "getEnvironment",
            "summary": "Returns the environment variables of an app from the current project.",
            "description": "",
            "description_parts": [],
            "file": "bbn\\Appui",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($hostname = NULL, $servname = NULL)\n  {\n    if ($this->check()) {\n      if ($hostname !== true) {\n        $idx = $this->getEnvironmentIndex($hostname, $servname);\n      }\n      if (empty($this->_environment)\n          && ($file = $this->getEnvironmentFile())\n          && ($content = file_get_contents($file))\n      ) {\n        if (substr($file, -4) === '.yml') {\n          $envs = yaml_parse($content);\n        }\n        else {\n          $envs = json_decode($content, true);\n        }\n\n        foreach ($envs as $i => $env) {\n          $md5                      = $this->getEnvironmentIndex($env['hostname'], $env['server_name']);\n          $this->_environment[$md5] = [\n            'index' => $i,\n            'data' => $env\n          ];\n        }\n      }\n\n      return $hostname === true ? array_values(\n        array_map(\n          function ($a) {\n            return $a['data'];\n          },\n          $this->_environment\n        )\n      ) : (\n        isset($this->_environment[$idx]) ?\n            $this->_environment[$idx]['data'] :\n            null\n      );\n    }\n\n    return null;\n  }",
            "startLine": 139,
            "endLine": 180,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 0,
            "returns": [
                "array",
                null
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "hostname",
                    "position": 0,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": null,
                    "default_name": "",
                    "description": "The URL of the environment."
                },
                {
                    "name": "servname",
                    "position": 1,
                    "type": "string",
                    "required": false,
                    "has_default": true,
                    "default": null,
                    "default_name": ""
                }
            ]
        },
        "getSettingsFile": {
            "name": "getSettingsFile",
            "summary": "Get the settings file location.",
            "description": "",
            "description_parts": [],
            "file": "bbn\\Appui",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    if ($this->check()) {\n      if (empty($this->_settings_file)) {\n        if (function_exists('\\\\yaml_parse') && is_file(BBN_APP_PATH.'src\/cfg\/settings.yml')) {\n          $this->_settings_file = BBN_APP_PATH.'src\/cfg\/settings.yml';\n        }\n        elseif (is_file(BBN_APP_PATH.'src\/cfg\/settings.json')) {\n          $this->_settings_file = BBN_APP_PATH.'src\/cfg\/settings.json';\n        }\n      }\n\n      return $this->_settings_file;\n    }\n\n    return null;\n  }",
            "startLine": 188,
            "endLine": 204,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                "string",
                null
            ],
            "parent": false,
            "arguments": []
        },
        "getEnvironmentFile": {
            "name": "getEnvironmentFile",
            "summary": "Get the environment file location.",
            "description": "",
            "description_parts": [],
            "file": "bbn\\Appui",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    if ($this->check()) {\n      if (empty($this->_environment_file)) {\n        if (function_exists('\\\\yaml_parse') && is_file(BBN_APP_PATH.'src\/cfg\/settings.yml')) {\n          $this->_environment_file = BBN_APP_PATH.'src\/cfg\/environment.yml';\n        }\n        elseif (is_file(BBN_APP_PATH.'src\/cfg\/settings.json')) {\n          $this->_environment_file = BBN_APP_PATH.'src\/cfg\/environment.json';\n        }\n      }\n\n      return $this->_environment_file;\n    }\n\n    return null;\n  }",
            "startLine": 212,
            "endLine": 228,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                "string",
                null
            ],
            "parent": false,
            "arguments": []
        },
        "setEnvironment": {
            "name": "setEnvironment",
            "summary": "Set environment vars",
            "description": "",
            "description_parts": [],
            "file": "bbn\\Appui",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(array $update, $hostname = NULL, $servname = NULL, $replace = false)\n  {\n      string $hostname = null,\n      string $servname = null,\n      bool $replace = false\n  ) : bool\n  {\n    if ($cfg = $this->getEnvironment(true)) {\n      $idx = $this->getEnvironmentIndex($hostname, $servname);\n      if (isset($this->_environment[$idx])) {\n        if ($replace) {\n          $this->_environment[$idx]['data'] = $update;\n        }\n        else {\n          $this->_environment[$idx]['data'] = array_merge(\n            $this->_environment[$idx]['data'],\n            $update\n          );\n        }\n\n        $file = $this->getEnvironmentFile();\n        $envs = $this->getEnvironment(true);\n        if (substr($file, -4) === '.yml') {\n          unlink($file);\n          return (bool)\\yaml_emit_file($file, $envs);\n        }\n        else {\n          return (bool)\\file_put_contents($file, Json_encode($envs, JSON_PRETTY_PRINT));\n        }\n      }\n    }\n\n    return false;\n  }",
            "startLine": 241,
            "endLine": 274,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 4,
            "numberOfRequiredParameters": 1,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "update",
                    "position": 0,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": "",
                    "description": "The environment's hostname"
                },
                {
                    "name": "hostname",
                    "position": 1,
                    "type": "string",
                    "required": false,
                    "has_default": true,
                    "default": null,
                    "default_name": "",
                    "description": "The environment's server name"
                },
                {
                    "name": "servname",
                    "position": 2,
                    "type": "string",
                    "required": false,
                    "has_default": true,
                    "default": null,
                    "default_name": "",
                    "description": "True if the whole value should be replaced by the new one"
                },
                {
                    "name": "replace",
                    "position": 3,
                    "type": "bool",
                    "required": false,
                    "has_default": true,
                    "default": false,
                    "default_name": ""
                }
            ]
        },
        "setSettings": {
            "name": "setSettings",
            "summary": "Set settings vars",
            "description": "",
            "description_parts": [],
            "file": "bbn\\Appui",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(array $update, $replace = false)\n  {\n    if ($this->getSettings()) {\n      if ($replace) {\n        $this->_settings = $update;\n      }\n      else {\n        $this->_settings = array_merge(\n          $this->_settings,\n          $update\n        );\n      }\n\n      $file = $this->getSettingsFile();\n      if (substr($file, -4) === '.yml') {\n        return (bool)\\yaml_emit_file($file, $this->_settings);\n      }\n      else {\n        return (bool)\\file_put_contents($file, Json_encode($this->_settings, JSON_PRETTY_PRINT));\n      }\n    }\n    else {\n      throw new \\Exception(X::_(\"Impossible to get the settings\"));\n    }\n\n    return false;\n  }",
            "startLine": 285,
            "endLine": 311,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 1,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "update",
                    "position": 0,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": "",
                    "description": "True if the whole value should be replaced by the new one"
                },
                {
                    "name": "replace",
                    "position": 1,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": false,
                    "default_name": ""
                }
            ]
        },
        "replaceEnvironment": {
            "name": "replaceEnvironment",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\Appui",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(array $update, $hostname = NULL, $servname = NULL)\n  {\n    return $this->setEnvironment($update, $hostname, $servname, true);\n  }",
            "startLine": 314,
            "endLine": 317,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 3,
            "numberOfRequiredParameters": 1,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "update",
                    "position": 0,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "hostname",
                    "position": 1,
                    "type": "string",
                    "required": false,
                    "has_default": true,
                    "default": null,
                    "default_name": ""
                },
                {
                    "name": "servname",
                    "position": 2,
                    "type": "string",
                    "required": false,
                    "has_default": true,
                    "default": null,
                    "default_name": ""
                }
            ]
        },
        "replaceSettings": {
            "name": "replaceSettings",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\Appui",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(array $update)\n  {\n    return $this->setSettings($update, true);\n  }",
            "startLine": 320,
            "endLine": 323,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "update",
                    "position": 0,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "addPlugin": {
            "name": "addPlugin",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\Appui",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($name, $title = NULL)\n  {\n    if (!$title) {\n      $title = $name;\n    }\n\n    \/** @var \\bbn\\Appui\\Option *\/\n    $o       = bbn\\Appui\\Option::getInstance();\n    $isAppui = substr($name, 0, 6) === 'appui-';\n    $name    = $isAppui ? substr($name, 6) : $name;\n    $params  = $isAppui ? ['appui'] : ['plugins'];\n    if ($id_parent = $o->fromCode(...$params)) {\n      array_unshift($params, $name);\n      if ($id = $o->fromCode(...$params)) {\n        return $id;\n      }\n      $id_plugin = $o->add([\n        'code' => $name,\n        'text' => $title,\n        'id_parent' => $id_parent\n      ]);\n      if (!$id_plugin) {\n        throw new \\Exception(X::_(\"Impossible to add the plugin\").\" $name\");\n      }\n\n      $perm_id = $o->add([\n        'id_parent' => $id_plugin,\n        'code' => 'permissions',\n        'text' => 'Permissions'\n      ]);\n      if (!$perm_id) {\n        throw new \\Exception(X::_(\"Impossible to add the permission for the plugin\").\" $name\");\n      }\n\n      \/\/ Other options under permissions\n      $o->add([\n        'id_parent' => $perm_id,\n        'code' => 'options',\n        'text' => 'Options'\n      ]);\n      $o->add([\n        'id_parent' => $perm_id,\n        'code' => 'plugins',\n        'text' => 'Plugins'\n      ]);\n    }\n\n    return null;\n  }",
            "startLine": 326,
            "endLine": 374,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "name",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "title",
                    "position": 1,
                    "type": "string",
                    "required": false,
                    "has_default": true,
                    "default": null,
                    "default_name": ""
                }
            ]
        }
    },
    "properties": null,
    "staticProperties": {
        "vars": [
            "env",
            "is_ssl",
            "admin_email",
            "db_engine",
            "db_host",
            "database",
            "db_user",
            "db_pass",
            "server_name",
            "hostname",
            "public",
            "cur_path",
            "app_path",
            "lib_path",
            "data_path",
            "log_path",
            "user",
            "preferences",
            "permissions",
            "options",
            "history",
            "encryption_key",
            "fingerprint",
            "app_name",
            "app_prefix",
            "site_title",
            "client_name"
        ]
    },
    "constants": null,
    "numMethods": 12,
    "numProperties": 0,
    "numConstants": 0,
    "numStaticProperties": 1,
    "interfaceNames": [],
    "isInterface": false,
    "traitNames": [],
    "traitAliases": [],
    "isTrait": false,
    "isAbstract": false,
    "isFinal": false,
    "modifiers": 0,
    "parentClass": null,
    "isSubclassOf": false,
    "defaultProperties": {
        "vars": [
            "env",
            "is_ssl",
            "admin_email",
            "db_engine",
            "db_host",
            "database",
            "db_user",
            "db_pass",
            "server_name",
            "hostname",
            "public",
            "cur_path",
            "app_path",
            "lib_path",
            "data_path",
            "log_path",
            "user",
            "preferences",
            "permissions",
            "options",
            "history",
            "encryption_key",
            "fingerprint",
            "app_name",
            "app_prefix",
            "site_title",
            "client_name"
        ],
        "_checked": false,
        "_settings_file": null,
        "_environment_file": null,
        "_settings": null,
        "_environment": null
    },
    "isIterable": false,
    "extensionName": false,
    "namespaceName": "bbn",
    "shortName": "Appui",
    "summary": ""
}