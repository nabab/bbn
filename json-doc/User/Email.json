{
    "doc": {
        "description": "",
        "tags": []
    },
    "name": "bbn\\User\\Email",
    "namespace": true,
    "traits": [
        "bbn\\Models\\Tts\\Dbconfig",
        "bbn\\Models\\Tts\\Optional"
    ],
    "interfaces": [],
    "fileName": "\/home\/thomas\/domains\/apstapp.thomas.lan\/_appui\/vendor\/bbn\/bbn\/src\/bbn\/User\/Email.php",
    "startLine": 9,
    "endLine": 1036,
    "contentConstructor": {
        "file": "bbn\\User\\Email",
        "returns": null
    },
    "methods": {
        "getFolderTypes": {
            "name": "getFolderTypes",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return self::getOptions('folders');\n  }",
            "startLine": 87,
            "endLine": 90,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                "array"
            ],
            "parent": false,
            "arguments": []
        },
        "getAccountTypes": {
            "name": "getAccountTypes",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return self::getOptions('types');\n  }",
            "startLine": 93,
            "endLine": 96,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                "array"
            ],
            "parent": false,
            "arguments": []
        },
        "__construct": {
            "name": "__construct",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(bbn\\Db $db, bbn\\User $user = NULL, bbn\\User\\Preferences $preferences = NULL)\n  {\n    self::optionalInit();\n    $this->_init_class_cfg();\n    $this->db   = $db;\n    $this->user = $user ?: bbn\\User::getInstance();\n    $this->pref = $preferences ?: bbn\\User\\Preferences::getInstance();\n  }",
            "startLine": 99,
            "endLine": 106,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 3,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "db",
                    "position": 0,
                    "type": "bbn\\Db",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "user",
                    "position": 1,
                    "type": "bbn\\User",
                    "required": false,
                    "has_default": true,
                    "default": null,
                    "default_name": ""
                },
                {
                    "name": "preferences",
                    "position": 2,
                    "type": "bbn\\User\\Preferences",
                    "required": false,
                    "has_default": true,
                    "default": null,
                    "default_name": ""
                }
            ]
        },
        "getMailbox": {
            "name": "getMailbox",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_account)\n  {\n    if (!isset($this->mboxes[$id_account])) {\n      $this->getAccount($id_account);\n    }\n\n    if (isset($this->mboxes[$id_account])) {\n      $mb = &$this->mboxes[$id_account];\n      if (!isset($mb['mailbox'])) {\n        $cfg           = $this->mboxes[$id_account];\n        $cfg['pass']   = $this->_get_password()->userGet($id_account, $this->user);\n        $mb['mailbox'] = new bbn\\Appui\\Mailbox($cfg);\n      }\n\n      if (isset($mb['mailbox'])) {\n        return $mb['mailbox'];\n      }\n    }\n\n    return null;\n\n  }",
            "startLine": 109,
            "endLine": 130,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id_account",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "getAccountsIds": {
            "name": "getAccountsIds",
            "summary": "Returns the list of the accounts' IDs of the current user.",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    if ($id_accounts = self::getOptionId('accounts')) {\n      return $this->pref->retrieveIds($id_accounts);\n    }\n\n    return null;\n  }",
            "startLine": 139,
            "endLine": 146,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                "array",
                null
            ],
            "parent": false,
            "arguments": []
        },
        "getAccounts": {
            "name": "getAccounts",
            "summary": "Returns the list of the accounts of the current user.",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($force = false)\n  {\n    $res = [];\n    if ($ids = $this->getAccountsIds()) {\n      foreach ($ids as $id) {\n        $res[] = $this->getAccount($id, $force);\n      }\n    }\n\n    return $res;\n  }",
            "startLine": 155,
            "endLine": 165,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 0,
            "returns": [
                "array"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "force",
                    "position": 0,
                    "type": "bool",
                    "required": false,
                    "has_default": true,
                    "default": false,
                    "default_name": ""
                }
            ]
        },
        "getAccount": {
            "name": "getAccount",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_account, $force = false)\n  {\n    if ($force || !isset($this->mboxes[$id_account])) {\n      if ($a = $this->pref->get($id_account)) {\n        $this->mboxes[$id_account] = [\n          'id' => $a['id'],\n          'host' => $a['host'] ?? null,\n          'login' => $a['login'],\n          'type' => $a['type'],\n          'port' => $a['port'] ?? null,\n          'ssl' => $a['ssl'] ?? true,\n          'folders' => null,\n          'last_uid' => $a['last_uid'] ?? null,\n          'last_check' => $a['last_check'] ?? null\n        ];\n        $this->mboxes[$id_account]['folders'] = $this->getFolders($this->mboxes[$id_account]);\n      }\n    }\n    return $this->mboxes[$id_account] ?? null;\n  }",
            "startLine": 168,
            "endLine": 187,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 1,
            "returns": [
                "array",
                null
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id_account",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "force",
                    "position": 1,
                    "type": "bool",
                    "required": false,
                    "has_default": true,
                    "default": false,
                    "default_name": ""
                }
            ]
        },
        "checkConfig": {
            "name": "checkConfig",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($cfg)\n  {\n    if (X::hasProps(['login', 'pass', 'type'], true)) {\n      $mb = new bbn\\Appui\\Mailbox($cfg);\n      return $mb->check();\n    }\n  }",
            "startLine": 190,
            "endLine": 196,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "cfg",
                    "position": 0,
                    "type": null,
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "updateAccount": {
            "name": "updateAccount",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_account, array $cfg)\n  {\n    if (X::hasProps($cfg, ['login', 'pass', 'type'], true)\n        && ($acc = $this->getAccount($id_account))\n        && ($this->pref->setCfg(\n          $id_account,\n          [\n            'host' => $cfg['host'] ?? null,\n            'login' => $cfg['login'],\n            'type' => $cfg['type'],\n            'port' => $cfg['port'] ?? null,\n            'ssl' => $cfg['ssl'] ?? true,\n            'last_uid' => $cfg['last_uid'] ?? null,\n            'last_check' => $cfg['last_check'] ?? null\n          ]\n        ))\n    ) {\n      return true;\n    }\n\n    return false;\n  }",
            "startLine": 199,
            "endLine": 220,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 2,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id_account",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "cfg",
                    "position": 1,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "deleteAccount": {
            "name": "deleteAccount",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_account)\n  {\n    return (bool)$this->pref->delete($id_account);\n  }",
            "startLine": 223,
            "endLine": 226,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id_account",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "addAccount": {
            "name": "addAccount",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(array $cfg)\n  {\n    if (!X::hasProps($cfg, ['login', 'pass', 'type'], true)) {\n      throw new \\Exception(\"Missing arguments\");\n    }\n\n    if (!($id_accounts = self::getOptionId('accounts'))) {\n      throw new \\Exception(\"Impossible to find the account option\");\n    }\n\n    \/\/ toGroup as this option will use different user options\n    if (!($id_pref = $this->pref->addToGroup(\n      $id_accounts,\n      [\n        'id_user' => $this->user->getId(),\n        'login' => $cfg['login'],\n        'type' => $cfg['type'],\n        'host' => $cfg['host'] ?? null,\n        'port' => $cfg['port'] ?? null,\n        'ssl' => $cfg['ssl'] ?? true\n      ]\n    ))\n    ) {\n      throw new \\Exception(\"Impossible to add the preference\");\n    }\n\n    if (!$this->_get_password()->userStore($cfg['pass'], $id_pref, $this->user)) {\n      throw new \\Exception(\"Impossible to set the password\");\n    }\n\n    $this->getAccount($id_pref, true);\n    if (!empty($cfg['folders'])) {\n      $this->syncFolders($id_pref, $cfg['folders']);\n    }\n\n    return $id_pref;\n  }",
            "startLine": 229,
            "endLine": 265,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [
                "string"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "cfg",
                    "position": 0,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "reset": {
            "name": "reset",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_account)\n  {\n    if (($account = $this->getAccount($id_account))\n        && ($num = $this->pref->deleteBits($id_account))\n    ) {\n      return true;\n    }\n\n    return false;\n  }",
            "startLine": 268,
            "endLine": 277,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id_account",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "createFolder": {
            "name": "createFolder",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_account, $name, $id_parent = NULL)\n  {\n\n    $this->createFolderDb($id, $id_parent);\n  }",
            "startLine": 280,
            "endLine": 284,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 3,
            "numberOfRequiredParameters": 2,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id_account",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "name",
                    "position": 1,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "id_parent",
                    "position": 2,
                    "type": "string",
                    "required": false,
                    "has_default": true,
                    "default": null,
                    "default_name": ""
                }
            ]
        },
        "createFolderDb": {
            "name": "createFolderDb",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_account, $name, $id_parent = NULL)\n  {\n\n  }",
            "startLine": 287,
            "endLine": 290,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 3,
            "numberOfRequiredParameters": 2,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id_account",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "name",
                    "position": 1,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "id_parent",
                    "position": 2,
                    "type": "string",
                    "required": false,
                    "has_default": true,
                    "default": null,
                    "default_name": ""
                }
            ]
        },
        "renameFolder": {
            "name": "renameFolder",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id, $name)\n  {\n\n    $this->renameFolderDb($id, $name);\n  }",
            "startLine": 293,
            "endLine": 297,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 2,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "name",
                    "position": 1,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "renameFolderDb": {
            "name": "renameFolderDb",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id, $name)\n  {\n\n  }",
            "startLine": 300,
            "endLine": 303,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 2,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "name",
                    "position": 1,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "deleteFolder": {
            "name": "deleteFolder",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id)\n  {\n    $this->deleteFolderDb($id);\n  }",
            "startLine": 306,
            "endLine": 309,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "deleteFolderDb": {
            "name": "deleteFolderDb",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id)\n  {\n\n  }",
            "startLine": 312,
            "endLine": 315,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "checkFolder": {
            "name": "checkFolder",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(array $folder, $sync = false)\n  {\n    if (X::hasProp($folder, 'uid')\n        && ($mb = $this->getMailbox($folder['id_account']))\n        && $mb->check()\n    ) {\n      if ($mb->update($folder['uid'])\n          && ($folders = $mb->getFolders())\n          && ($res = $folders[$folder['uid']])\n      ) {\n        if ($folder['last_uid'] !== $res['last_uid']) {\n          $id_account = $folder['id_account'];\n          unset($folder['id_account']);\n          $res = array_merge($folder, $res);\n          $this->pref->updateBit($folder['id'], $res, true);\n          $res['id_account'] = $id_account;\n          $this->getAccount($id_account, true);\n          if ($sync) {\n            $this->syncEmails($res);\n          }\n        }\n\n        return $res;\n      }\n    }\n\n    return null;\n\n  }",
            "startLine": 318,
            "endLine": 346,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "folder",
                    "position": 0,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "sync",
                    "position": 1,
                    "type": null,
                    "required": false,
                    "has_default": true,
                    "default": false,
                    "default_name": ""
                }
            ]
        },
        "getFolders": {
            "name": "getFolders",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($account, $force = false)\n  {\n    $acc = is_array($account) ? $account : $acc = $this->getAccount($account);\n    if ($acc) {\n      $types = self::getFolderTypes();\n      if ($force) {\n        $this->syncFolders($acc['id']);\n      }\n\n      $cfg   = $this->class_cfg['arch']['users_emails'];\n      $table = $this->class_cfg['tables']['users_emails'];\n      \/\/die(X::dump($this->pref->getFullBits($acc['id'])));\n      return X::map(\n        function ($a) use ($types, $cfg, $table) {\n          if (!isset($a['uid'])) {\n\n            \/\/die(X::dump(\"NO UID\", $a, debug_backtrace()));\n          }\n\n          $res = [\n            'id' => $a['id'],\n            'id_account' => $a['id_user_option'],\n            'text' => $a['text'],\n            'uid' => $a['uid'],\n            'id_option' => $a['id_option'],\n            'type' => X::getField($types, ['id' => $a['id_option']], 'code'),\n            'db_uid' => $this->db->selectOne(\n              $table,\n              'MAX('.$this->db->csn($cfg['msg_uid'], true).')',\n              [\n                $cfg['id_folder'] => $a['id'],\n                $cfg['id_user'] => $this->user->getId()\n              ]\n            ),\n            'last_uid' => $a['last_uid'] ?? null,\n            'last_check' => $a['last_check'] ?? null\n          ];\n          if (!empty($a['items'])) {\n            $res['items'] = $a['items'];\n          }\n\n          return $res;\n        },\n        $this->pref->getFullBits($acc['id']),\n        'items'\n      );\n    }\n\n    return null;\n  }",
            "startLine": 349,
            "endLine": 398,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "account",
                    "position": 0,
                    "type": null,
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "force",
                    "position": 1,
                    "type": null,
                    "required": false,
                    "has_default": true,
                    "default": false,
                    "default_name": ""
                }
            ]
        },
        "getFolder": {
            "name": "getFolder",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id, $force = false)\n  {\n    $types = self::getFolderTypes();\n    $cfg   = $this->class_cfg['arch']['users_emails'];\n    $table = $this->class_cfg['tables']['users_emails'];\n    $a = $this->pref->getBit($id);\n    if ($a) {\n      return [\n        'id' => $a['id'],\n        'id_account' => $a['id_user_option'],\n        'text' => $a['text'],\n        'uid' => $a['uid'],\n        'id_option' => $a['id_option'],\n        'type' => X::getField($types, ['id' => $a['id_option']], 'code'),\n        'db_uid' => $this->db->selectOne(\n          $table,\n          'MAX('.$this->db->csn($cfg['msg_uid'], true).')',\n          [\n            $cfg['id_folder'] => $a['id'],\n            $cfg['id_user'] => $this->user->getId()\n          ]\n        ),\n        'last_uid' => $a['last_uid'] ?? null,\n        'last_check' => $a['last_check'] ?? null\n      ];\n    }\n\n    return null;\n  }",
            "startLine": 401,
            "endLine": 429,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 1,
            "returns": [
                "array",
                null
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "force",
                    "position": 1,
                    "type": "bool",
                    "required": false,
                    "has_default": true,
                    "default": false,
                    "default_name": ""
                }
            ]
        },
        "syncEmails": {
            "name": "syncEmails",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(array $folder, $limit = 0)\n  {\n    if (X::hasProps($folder, ['id', 'id_account', 'last_uid', 'uid'])) {\n      $res = 0;\n      if ($folder['last_uid'] && ($folder['last_uid'] !== $folder['db_uid'])) {\n        $mb = $this->getMailbox($folder['id_account']);\n        if ($mb->selectFolder($folder['uid'])) {\n          $start = 1;\n          if (!empty($folder['db_uid'])) {\n            try {\n              $start = $mb->getMsgNo($folder['db_uid']);\n            }\n            catch (\\Exception $e) {\n              $start = 1;\n            }\n          }\n          $real_end = 1;\n          if (!empty($folder['last_uid'])) {\n            try {\n              $real_end = $mb->getMsgNo($folder['last_uid']);\n            }\n            catch (\\Exception $e) {\n              $real_end = 1;\n            }\n          }\n\n          \/** @todo temporary solution to avoid errors *\/\n          if ($start === $real_end) {\n            return 0;\n          }\n\n          if ($limit) {\n            $real_end = min($real_end, $start + $limit);\n          }\n\n          $end      = $start;\n          $num      = $real_end - $start;\n          \/\/var_dump($folder, $num, $real_end);\n          while ($end <= $real_end) {\n            $end = min($real_end, $start + 999);\n            if ($all = $mb->getEmailsList($folder['uid'], $start, $end)) {\n              $start += 1000;\n              \/\/var_dump($start, $end);\n              foreach ($all as $a) {\n                if ($this->insertEmail($folder, $a)) {\n                  $res++;\n                }\n                else {\n                  \/\/throw new \\Exception(X::_(\"Impossible to insert the email with ID\").' '.$a['message_id']);\n                  $this->log(X::_(\"Impossible to insert the email with ID\").' '.$a['message_id']);\n                }\n              }\n\n              if ($end === $real_end) {\n                $this->pref->updateBit($folder['id'], ['last_check' => date('Y-m-d H:i:s')], true);\n                break;\n              }\n            }\n            else {\n              throw new \\Exception(\n                X::_(\"Impossible to get the emails for folder\")\n                .' '.$folder['uid']\n                .' '.X::_(\"from\").' '.$start\n                .' '.X::_(\"to\").' '.$end\n                .' ('.$real_end.')'\n              );\n            }\n          }\n        }\n      }\n      return $res;\n    }\n\n    return null;\n  }",
            "startLine": 432,
            "endLine": 506,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 1,
            "returns": [
                "int",
                null
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "folder",
                    "position": 0,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "limit",
                    "position": 1,
                    "type": "int",
                    "required": false,
                    "has_default": true,
                    "default": 0,
                    "default_name": ""
                }
            ]
        },
        "getList": {
            "name": "getList",
            "summary": "Returns a list of emails based on their folder.",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_folder, array $post)\n  {\n    if ($ids = $this->idsFromFolder($id_folder)) {\n      $cfg      = $this->class_cfg['arch']['users_emails'];\n      $table    = $this->class_cfg['tables']['users_emails'];\n      $real_filter = [\n        'logic' => 'AND',\n        'conditions' => [\n          $cfg['id_folder'] => $ids\n        ]\n      ];\n      if (!empty($post['filters'])) {\n        if (!isset($post['filters']['conditions'])) {\n          $post['filters'] = ['conditions' => $post['filters']];\n        }\n\n        if (!empty($post['filters']['conditions'])) {\n          $real_filter['conditions'][] = $post['filters'];\n        }\n      }\n\n      $post['filters'] = $real_filter;\n      $grid = new \\bbn\\Appui\\Grid($this->db, $post, [\n        'table' => $table,\n        'fields' => $cfg\n      ]);\n\n      if ($grid->check()) {\n        return $grid->getDatatable();\n      }\n    }\n\n    return null;\n  }",
            "startLine": 519,
            "endLine": 552,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 2,
            "returns": [
                "array",
                null
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id_folder",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "post",
                    "position": 1,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "getEmail": {
            "name": "getEmail",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id)\n  {\n    $cfg      = $this->class_cfg['arch']['users_emails'];\n    $table    = $this->class_cfg['tables']['users_emails'];\n    $em = $this->db->rselect($table, $cfg, [$cfg['id'] => $id]);\n    if ($em) {\n      $folder = $this->getFolder($em['id_folder']);\n      if ($folder\n          && ($mb = $this->getMailbox($folder['id_account']))\n          && $mb->selectFolder($folder['uid'])\n          && ($number = $mb->getMsgNo($em['msg_uid']))\n      ) {\n        return $mb->getMsg($number);\n      }\n    }\n    return null;\n  }",
            "startLine": 555,
            "endLine": 571,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [
                "array",
                null
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": null,
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "insertEmail": {
            "name": "insertEmail",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(array $folder, array $email)\n  {\n    if (X::hasProps($email, ['from', 'uid'])) {\n      $cfg      = $this->class_cfg['arch']['users_emails'];\n      $table    = $this->class_cfg['tables']['users_emails'];\n      $existing = $this->db->selectOne(\n        $table,\n        $cfg['id'],\n        [\n          $cfg['id_user'] => $this->user->getId(),\n          $cfg['msg_unique_id'] => $email['message_id']\n        ]\n      );\n      foreach (bbn\\Appui\\MailboX::getDestFields() as $df) {\n        if (!empty($email[$df])) {\n          foreach ($email[$df] as &$dest) {\n            if ($id = $this->retrieveEmail($dest['email'])) {\n              $sent_opt = X::getField(self::getFolderTypes(), ['code' => 'sent'], 'id');\n              if ($sent_opt === $folder['id_option']) {\n                $this->addSentToLink($id, Date('Y-m-d H:i:s', strtotime($email['date'])));\n              }\n            }\n            elseif (!($id = $this->addContactFromMail($dest))) {\n              throw new \\Exception(X::_(\"Impossible to add the contact\").' '.$dest['email']);\n            }\n\n            $dest['id'] = $id;\n          }\n\n          if ($df === 'from') {\n            $id_sender = $id;\n          }\n        }\n      }\n\n      if (!empty($id_sender)) {\n        $id_parent = null;\n        $id_thread = null;\n        if (!empty($email['in_reply_to'])) {\n          $tmp = $this->db->rselect(\n            $table,\n            [$cfg['id'], $cfg['id_thread']],\n            [\n              $cfg['id_user'] => $this->user->getId(),\n              $cfg['msg_unique_id'] => $email['in_reply_to']\n            ]\n          );\n          if ($tmp) {\n            $id_parent = $tmp[$cfg['id']];\n            $id_thread = $tmp[$cfg['id_thread']] ?: $id_parent;\n          }\n        }\n\n        \/\/die(var_dump($email));\n        $external = null;\n        if (!empty($email['in_reply_to']) || !empty($email['references'])) {\n          $external = [\n            'in_reply_to' => $email['in_reply_to'] ?? null,\n            'references'  => $email['references'] ?? null\n          ];\n        }\n\n        $ar = [\n          $cfg['id_user'] => $this->user->getId(),\n          $cfg['id_folder'] => $folder['id'],\n          $cfg['msg_uid'] => $email['uid'],\n          $cfg['msg_unique_id'] => $email['message_id'],\n          $cfg['date'] => date('Y-m-d H:i:s', strtotime($email['date'])),\n          $cfg['id_sender'] => $id_sender,\n          $cfg['subject'] => empty($email['subject']) ? '' : mb_decode_mimeheader($email['subject']),\n          $cfg['size'] => $email['Size'],\n          $cfg['attachments'] => empty($email['attachments']) ? null : json_encode($email['attachments']),\n          $cfg['flags'] => $email['Flagged'] ?: null,\n          $cfg['is_read'] => $email['Unseen'] ? 0 : 1,\n          $cfg['id_parent'] => $id_parent,\n          $cfg['id_thread'] => $id_thread,\n          $cfg['external_uids'] => json_encode($external)\n        ];\n        $id = false;\n        if ($existing) {\n          \/\/die(var_dump($ar));\n          \/\/$this->db->update($table, $ar, [$cfg['id'] => $existing]);\n          $id = $existing;\n        }\n        elseif ($this->db->insert($table, $ar)) {\n          $id = $this->db->lastId();\n        }\n\n        if ($id) {\n          foreach (bbn\\Appui\\MailboX::getDestFields() as $df) {\n            if (in_array($df, ['to', 'cc', 'bcc']) && !empty($email[$df])) {\n              foreach ($email[$df] as $dest) {\n                if (!empty($dest['id'])) {\n                  $this->addLinkToMail($id, $dest['id'], $df);\n                }\n              }\n            }\n          }\n\n          return $id;\n        }\n      }\n    }\n    $this->log($email);\n    \/\/throw new \\Exception(X::_(\"Invalid email\"));\n  }",
            "startLine": 574,
            "endLine": 679,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 2,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "folder",
                    "position": 0,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "email",
                    "position": 1,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "addContactFromMail": {
            "name": "addContactFromMail",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(array $dest, $blacklist = false)\n  {\n    if (X::hasProp($dest, 'email', true)) {\n      $cfg_contacts   = $this->class_cfg['arch']['users_contacts'];\n      $cfg_links      = $this->class_cfg['arch']['users_contacts_links'];\n      $table_contacts = $this->class_cfg['tables']['users_contacts'];\n      $table_links = $this->class_cfg['tables']['users_contacts_links'];\n      if ($this->db->insert($table_contacts, [\n        $cfg_contacts['id_user']   => $this->user->getId(),\n        $cfg_contacts['name']      => $dest['name'] ?? null,\n        $cfg_contacts['blacklist'] => $blacklist ? 1 : 0\n      ])) {\n        $id_contact = $this->db->lastId();\n        if ($this->db->insert($table_links, [\n          'id_contact' => $id_contact,\n          'type' => 'email',\n          'value' => $dest['email']\n        ])) {\n          return $this->db->lastId();\n        }\n      }\n    }\n\n    return null;\n  }",
            "startLine": 682,
            "endLine": 706,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 1,
            "returns": [
                "string",
                null
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "dest",
                    "position": 0,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "blacklist",
                    "position": 1,
                    "type": "bool",
                    "required": false,
                    "has_default": true,
                    "default": false,
                    "default_name": ""
                }
            ]
        },
        "getLink": {
            "name": "getLink",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id)\n  {\n    $cfg   = $this->class_cfg['arch']['users_contacts_links'];\n    $table = $this->class_cfg['tables']['users_contacts_links'];\n    $data  = $this->db->rselect($table, $cfg, [$cfg['id'] => $id]);\n    return $data ?: null;\n  }",
            "startLine": 709,
            "endLine": 715,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [
                "array",
                null
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": null,
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "addLinkToMail": {
            "name": "addLinkToMail",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_email, $id_link, $type)\n  {\n    $cfg   = $this->class_cfg['arch']['users_emails_recipients'];\n    $table = $this->class_cfg['tables']['users_emails_recipients'];\n    return (bool)$this->db->insertIgnore(\n      $table,\n      [\n        $cfg['id_email'] => $id_email,\n        $cfg['id_contact_link'] => $id_link,\n        $cfg['type'] => $type\n      ]\n    );\n\n  }",
            "startLine": 718,
            "endLine": 731,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 3,
            "numberOfRequiredParameters": 3,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id_email",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "id_link",
                    "position": 1,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "type",
                    "position": 2,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "addSentToLink": {
            "name": "addSentToLink",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_link, $date = NULL)\n  {\n    if ($link = $this->getLink($id_link)) {\n      $cfg   = $this->class_cfg['arch']['users_contacts_links'];\n      $table = $this->class_cfg['tables']['users_contacts_links'];\n      if (!$date) {\n        $date = date('Y-m-d H:i:s');\n      }\n      if ($link['last_sent'] && ($link['last_sent'] > $date))  {\n        $date = $link['last_sent'];\n      }\n\n      return (bool)$this->db->update(\n        $table,\n        [\n          $cfg['num_sent']  => $link[$cfg['num_sent']] + 1,\n          $cfg['last_sent'] => $date\n        ], [\n          'id' => $id_link\n        ]\n      );\n    }\n\n    return false;\n  }",
            "startLine": 734,
            "endLine": 758,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 1,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id_link",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "date",
                    "position": 1,
                    "type": "string",
                    "required": false,
                    "has_default": true,
                    "default": null,
                    "default_name": ""
                }
            ]
        },
        "retrieveEmail": {
            "name": "retrieveEmail",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($email)\n  {\n    $contacts = $this->class_cfg['tables']['users_contacts'];\n    $cfg_c    = $this->class_cfg['arch']['users_contacts'];\n    $links    = $this->class_cfg['tables']['users_contacts_links'];\n    $cfg_l    = $this->class_cfg['arch']['users_contacts_links'];\n    return $this->db->selectOne(\n      [\n        'tables' => [$links],\n        'field'  => $this->db->cfn($cfg_l['id'], $links),\n        'join'   => [\n          [\n            'table' => $contacts,\n            'on'    => [\n              [\n                'field' => $cfg_l['id_contact'],\n                'exp'   => $this->db->cfn($cfg_c['id'], $contacts)\n              ]\n            ]\n\n          ]\n        ],\n        'where' => [\n          'value' => $email,\n          'id_user' => $this->user->getId(),\n          'type' => 'email'\n        ]\n      ]\n    );\n  }",
            "startLine": 761,
            "endLine": 790,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "email",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "getContact": {
            "name": "getContact",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($email, $name, $force)\n  {\n\n  }",
            "startLine": 793,
            "endLine": 796,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 3,
            "numberOfRequiredParameters": 3,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "email",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "name",
                    "position": 1,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "force",
                    "position": 2,
                    "type": null,
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "getContacts": {
            "name": "getContacts",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    $contacts = $this->class_cfg['tables']['users_contacts'];\n    $cfg_c    = $this->class_cfg['arch']['users_contacts'];\n    $links    = $this->class_cfg['tables']['users_contacts_links'];\n    $cfg_l    = $this->class_cfg['arch']['users_contacts_links'];\n    $rows = $this->db->rselectAll(\n      [\n        'tables' => [$links],\n        'fields'  => [\n          $this->db->cfn($cfg_l['id'], $links),\n          $this->db->cfn($cfg_l['value'], $links),\n          $this->db->cfn($cfg_l['id_contact'], $links),\n          $this->db->cfn($cfg_l['num_sent'], $links),\n          $this->db->cfn($cfg_l['last_sent'], $links),\n          $this->db->cfn($cfg_c['name'], $contacts),\n          $this->db->cfn($cfg_c['cfg'], $contacts),\n          $this->db->cfn($cfg_c['blacklist'], $contacts),\n          'sortIndex' => 'IFNULL('.$this->db->cfn($cfg_c['name'], $contacts, true).','.$this->db->cfn($cfg_l['value'], $links).')'\n        ],\n        'join'   => [\n          [\n            'table' => $contacts,\n            'on'    => [\n              [\n                'field' => $cfg_l['id_contact'],\n                'exp'   => $this->db->cfn($cfg_c['id'], $contacts)\n              ]\n            ]\n\n          ]\n        ],\n        'where' => [\n          'id_user' => $this->user->getId(),\n          'type' => 'email'\n        ],\n        'order' => [\n          'sortIndex' => 'ASC'\n        ]\n      ]\n    );\n    $res = [];\n    if ($rows) {\n      foreach ($rows as $r) {\n        $res[] = [\n          'value' => $r['id'],\n          'text' => (empty($r['name']) ? '' : $r['name'].' - ').$r['value'],\n          'cfg' => empty($r['cfg']) ? [] : json_decode($r['cfg'], true),\n          'id_contact' => $r['id_contact'],\n          'num_sent' => $r['num_sent'],\n          'last_sent' => $r['last_sent'],\n          'blacklist' => $r['blacklist']\n        ];\n      }\n    }\n\n    return $res;\n  }",
            "startLine": 799,
            "endLine": 856,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                "array"
            ],
            "parent": false,
            "arguments": []
        },
        "syncFolders": {
            "name": "syncFolders",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_account, array $subscribed = [])\n  {\n    if ($mb = $this->getMailbox($id_account)) {\n      $mbParam = $mb->getParams();\n      $types   = self::getFolderTypes();\n\n      $put_in_res = function (array $a, &$res, $prefix = '') use (&$put_in_res, $subscribed) {\n        $ele = array_shift($a);\n        $idx = X::find($res, ['text' => $ele]);\n        if (null === $idx) {\n          $idx   = count($res);\n          $res[] = [\n            'text' => $ele,\n            'uid' => $prefix.$ele,\n            'items' => [],\n            'subscribed' => in_array($prefix.$ele, $subscribed)\n          ];\n        }\n\n        if (count($a)) {\n          $put_in_res($a, $res[$idx]['items'], $prefix.$ele.'.');\n        }\n      };\n\n      $compare = function (\n          array $real,\n          array $db,\n          array &$res = null,\n          $id_parent = null\n      ) use (&$compare): array {\n        if (!$res) {\n          $res = ['add' => [], 'delete' => []];\n        }\n\n        foreach ($real as $r) {\n          $idx = X::find($db, ['text' => $r['text']]);\n          if (null === $idx) {\n            if ($id_parent) {\n              $r['id_parent'] = $id_parent;\n            }\n\n            $res['add'][] = $r;\n          }\n          elseif ($r['items'] && $db[$idx]['items']) {\n            $compare($r['items'], $db[$idx]['items'], $res, $db[$idx]['id']);\n          }\n        }\n\n        foreach ($db as $r) {\n          $idx = X::find($real, ['text' => $r['text']]);\n          if (null === $idx) {\n            $res['delete'][] = $r;\n          }\n        }\n\n        return $res;\n      };\n\n      $pref = $this->pref;\n\n      $import = function (array $to_add, $id_parent = null) use ($id_account, &$pref, &$import, &$types) {\n        foreach ($to_add as $a) {\n          if ($id_parent) {\n            $a['id_parent'] = $id_parent;\n            $a['id_option'] = X::getField($types, ['code' => 'folders'], 'id');\n          }\n          else {\n            foreach ($types as $type) {\n              if (!empty($type['names'])) {\n                if (in_array($a['text'], $type['names'], true)) {\n                  $a['id_option'] = $type['id'];\n                  break;\n                }\n              }\n            }\n\n            if (!isset($a['id_option'])) {\n              $a['id_option'] = X::getField($types, ['code' => 'folders'], 'id');\n            }\n          }\n\n          if ($id_bit = $pref->addBit($id_account, $a)) {\n            if (!empty($a['items'])) {\n              $import($a['items'], $id_bit);\n            }\n          }\n        }\n      };\n\n      $res = [];\n      $all = $mb->listAllFolders();\n      foreach ($all as $dir) {\n        $tmp = str_replace($mbParam, '', $dir);\n        $bits = X::split($tmp, '.');\n        $put_in_res($bits, $res);\n      }\n\n      \/\/ We have a tree\n      $db_tree = $this->pref->getFullBits($id_account);\n\n      $result = $compare($res, $db_tree);\n\n      $import($result['add']);\n\n      return ['real' => $res, 'db' => $db_tree, 'compare' => $result];\n    }\n\n    return null;\n  }",
            "startLine": 859,
            "endLine": 967,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id_account",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "subscribed",
                    "position": 1,
                    "type": "array",
                    "required": false,
                    "has_default": true,
                    "default": [],
                    "default_name": ""
                }
            ]
        },
        "getStructure": {
            "name": "getStructure",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_account, $force)\n  {\n\n  }",
            "startLine": 970,
            "endLine": 973,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 2,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id_account",
                    "position": 0,
                    "type": null,
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "force",
                    "position": 1,
                    "type": null,
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "test": {
            "name": "test",
            "summary": "Checks whether the error property has been set (so an error happened).",
            "description": "",
            "description_parts": [],
            "file": "bbn\\Models\\Cls\\Basic",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    if ($this->error) {\n      return false;\n    }\n\n    return true;\n  }",
            "startLine": 51,
            "endLine": 58,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": {
                "name": "test",
                "summary": "Checks whether the error property has been set (so an error happened).",
                "description": "",
                "description_parts": [],
                "file": "bbn\\Models\\Cls\\Basic",
                "static": false,
                "visibility": "public",
                "final": false,
                "code": "function()\n  {\n    if ($this->error) {\n      return false;\n    }\n\n    return true;\n  }",
                "startLine": 51,
                "endLine": 58,
                "isDeprecated": false,
                "isGenerator": false,
                "isInternal": false,
                "isUserDefined": true,
                "isVariadic": false,
                "returnsReference": false,
                "numberOfParameters": 0,
                "numberOfRequiredParameters": 0,
                "returns": null,
                "parent": false,
                "arguments": []
            },
            "arguments": []
        },
        "check": {
            "name": "check",
            "summary": "Checks whether the error property has been set (so an error happened).",
            "description": "",
            "description_parts": [],
            "file": "bbn\\Models\\Cls\\Basic",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    if ($this->error) {\n      return false;\n    }\n\n    return true;\n  }",
            "startLine": 65,
            "endLine": 72,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": {
                "name": "check",
                "summary": "Checks whether the error property has been set (so an error happened).",
                "description": "",
                "description_parts": [],
                "file": "bbn\\Models\\Cls\\Basic",
                "static": false,
                "visibility": "public",
                "final": false,
                "code": "function()\n  {\n    if ($this->error) {\n      return false;\n    }\n\n    return true;\n  }",
                "startLine": 65,
                "endLine": 72,
                "isDeprecated": false,
                "isGenerator": false,
                "isInternal": false,
                "isUserDefined": true,
                "isVariadic": false,
                "returnsReference": false,
                "numberOfParameters": 0,
                "numberOfRequiredParameters": 0,
                "returns": null,
                "parent": false,
                "arguments": []
            },
            "arguments": []
        },
        "getError": {
            "name": "getError",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\Models\\Cls\\Basic",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return $this->error;\n  }",
            "startLine": 86,
            "endLine": 89,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": {
                "name": "getError",
                "summary": "",
                "description": "",
                "description_parts": [],
                "file": "bbn\\Models\\Cls\\Basic",
                "static": false,
                "visibility": "public",
                "final": false,
                "code": "function()\n  {\n    return $this->error;\n  }",
                "startLine": 86,
                "endLine": 89,
                "isDeprecated": false,
                "isGenerator": false,
                "isInternal": false,
                "isUserDefined": true,
                "isVariadic": false,
                "returnsReference": false,
                "numberOfParameters": 0,
                "numberOfRequiredParameters": 0,
                "returns": null,
                "parent": false,
                "arguments": []
            },
            "arguments": []
        },
        "getErrors": {
            "name": "getErrors",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\Models\\Cls\\Basic",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n\n  }",
            "startLine": 92,
            "endLine": 95,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": {
                "name": "getErrors",
                "summary": "",
                "description": "",
                "description_parts": [],
                "file": "bbn\\Models\\Cls\\Basic",
                "static": false,
                "visibility": "public",
                "final": false,
                "code": "function()\n  {\n\n  }",
                "startLine": 92,
                "endLine": 95,
                "isDeprecated": false,
                "isGenerator": false,
                "isInternal": false,
                "isUserDefined": true,
                "isVariadic": false,
                "returnsReference": false,
                "numberOfParameters": 0,
                "numberOfRequiredParameters": 0,
                "returns": null,
                "parent": false,
                "arguments": []
            },
            "arguments": []
        },
        "log": {
            "name": "log",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\Models\\Cls\\Basic",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    if ($this->isDebug()) {\n        $ar = \\func_get_args();\n        $cn = bbn\\Str::encodeFilename(str_replace('\\\\', '_', \\get_class($this)));\n      foreach ($ar as $a){\n            X::log($a, $cn);\n      }\n    }\n  }",
            "startLine": 98,
            "endLine": 107,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": {
                "name": "log",
                "summary": "",
                "description": "",
                "description_parts": [],
                "file": "bbn\\Models\\Cls\\Basic",
                "static": false,
                "visibility": "public",
                "final": false,
                "code": "function()\n  {\n    if ($this->isDebug()) {\n        $ar = \\func_get_args();\n        $cn = bbn\\Str::encodeFilename(str_replace('\\\\', '_', \\get_class($this)));\n      foreach ($ar as $a){\n            X::log($a, $cn);\n      }\n    }\n  }",
                "startLine": 98,
                "endLine": 107,
                "isDeprecated": false,
                "isGenerator": false,
                "isInternal": false,
                "isUserDefined": true,
                "isVariadic": false,
                "returnsReference": false,
                "numberOfParameters": 0,
                "numberOfRequiredParameters": 0,
                "returns": null,
                "parent": false,
                "arguments": []
            },
            "arguments": []
        },
        "__call": {
            "name": "__call",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\Models\\Cls\\Basic",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($name, $arguments)\n  {\n    $class = \\get_class($this);\n    throw new \\Exception(\n      sprintf(\n        X::_(\"Wrong method used for the class %s: %s with the following arguments:\"),\n        $class,\n        $name,\n        implode(', ', $arguments)\n      )\n    );\n  }",
            "startLine": 115,
            "endLine": 126,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 2,
            "returns": null,
            "parent": {
                "name": "__call",
                "summary": "",
                "description": "",
                "description_parts": [],
                "file": "bbn\\Models\\Cls\\Basic",
                "static": false,
                "visibility": "public",
                "final": false,
                "code": "function($name, $arguments)\n  {\n    $class = \\get_class($this);\n    throw new \\Exception(\n      sprintf(\n        X::_(\"Wrong method used for the class %s: %s with the following arguments:\"),\n        $class,\n        $name,\n        implode(', ', $arguments)\n      )\n    );\n  }",
                "startLine": 115,
                "endLine": 126,
                "isDeprecated": false,
                "isGenerator": false,
                "isInternal": false,
                "isUserDefined": true,
                "isVariadic": false,
                "returnsReference": false,
                "numberOfParameters": 2,
                "numberOfRequiredParameters": 2,
                "returns": null,
                "parent": false,
                "arguments": [
                    {
                        "name": "name",
                        "position": 0,
                        "type": null,
                        "required": true,
                        "has_default": false,
                        "default": "",
                        "default_name": ""
                    },
                    {
                        "name": "arguments",
                        "position": 1,
                        "type": null,
                        "required": true,
                        "has_default": false,
                        "default": "",
                        "default_name": ""
                    }
                ]
            },
            "arguments": [
                {
                    "name": "name",
                    "position": 0,
                    "type": null,
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "arguments",
                    "position": 1,
                    "type": null,
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "isDebug": {
            "name": "isDebug",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\Models\\Cls\\Basic",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return $this->debug || (defined(\"BBN_IS_DEV\") && BBN_IS_DEV);\n  }",
            "startLine": 132,
            "endLine": 135,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": {
                "name": "isDebug",
                "summary": "",
                "description": "",
                "description_parts": [],
                "file": "bbn\\Models\\Cls\\Basic",
                "static": false,
                "visibility": "public",
                "final": false,
                "code": "function()\n  {\n    return $this->debug || (defined(\"BBN_IS_DEV\") && BBN_IS_DEV);\n  }",
                "startLine": 132,
                "endLine": 135,
                "isDeprecated": false,
                "isGenerator": false,
                "isInternal": false,
                "isUserDefined": true,
                "isVariadic": false,
                "returnsReference": false,
                "numberOfParameters": 0,
                "numberOfRequiredParameters": 0,
                "returns": null,
                "parent": false,
                "arguments": []
            },
            "arguments": []
        },
        "setDebug": {
            "name": "setDebug",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\Models\\Cls\\Basic",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($debug)\n  {\n    $this->debug = $debug;\n  }",
            "startLine": 142,
            "endLine": 145,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": {
                "name": "setDebug",
                "summary": "",
                "description": "",
                "description_parts": [],
                "file": "bbn\\Models\\Cls\\Basic",
                "static": false,
                "visibility": "public",
                "final": false,
                "code": "function($debug)\n  {\n    $this->debug = $debug;\n  }",
                "startLine": 142,
                "endLine": 145,
                "isDeprecated": false,
                "isGenerator": false,
                "isInternal": false,
                "isUserDefined": true,
                "isVariadic": false,
                "returnsReference": false,
                "numberOfParameters": 1,
                "numberOfRequiredParameters": 1,
                "returns": null,
                "parent": false,
                "arguments": [
                    {
                        "name": "debug",
                        "position": 0,
                        "type": "bool",
                        "required": true,
                        "has_default": false,
                        "default": "",
                        "default_name": ""
                    }
                ]
            },
            "arguments": [
                {
                    "name": "debug",
                    "position": 0,
                    "type": "bool",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "exists": {
            "name": "exists",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id)\n  {\n    if (!$this->class_table_index) {\n      throw new \\Exception(X::_(\"The table index parameter should be defined\"));\n    }\n\n    $res = $this->db->count(\n      $this->class_table, [\n      $this->class_cfg['arch'][$this->class_table_index]['id'] => $id\n      ]\n    );\n    return (bool)$res;\n  }",
            "startLine": 33,
            "endLine": 45,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": null,
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "getClassCfg": {
            "name": "getClassCfg",
            "summary": "Returns the class configuration.",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return $this->class_cfg;\n  }",
            "startLine": 53,
            "endLine": 56,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "getFields": {
            "name": "getFields",
            "summary": "Returns the fields of the main table.",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return $this->fields;\n  }",
            "startLine": 64,
            "endLine": 67,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "insert": {
            "name": "insert",
            "summary": "Inserts a new row in the table.",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(array $data)\n  {\n    if ($data = $this->prepare($data)) {\n      $ccfg = $this->getClassCfg();\n      if ($this->db->insert($ccfg['table'], $data)) {\n        return $this->db->lastId();\n      }\n    }\n\n    return null;\n  }",
            "startLine": 77,
            "endLine": 87,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [
                "string",
                null
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "data",
                    "position": 0,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "delete": {
            "name": "delete",
            "summary": "Deletes a single row from the table through its id.",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id)\n  {\n    if ($data = $this->exists($id)) {\n      $ccfg = $this->getClassCfg();\n      $f = $ccfg['arch'][$this->class_table_index];\n      return !!$this->db->delete($ccfg['table'], [$f['id'] => $id]);\n    }\n\n    return false;\n  }",
            "startLine": 97,
            "endLine": 106,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "update": {
            "name": "update",
            "summary": "Updates a single row in the table through its id.",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id, array $data, $addCfg = false)\n  {\n    if (!$this->exists($id)) {\n      throw new \\Exception(X::_(\"Impossible to find the given row\"));\n    }\n\n    if ($addCfg) {\n      $data = array_merge($this->select($id), $data);\n    }\n\n    if ($data = $this->prepare($data)) {\n      $ccfg = $this->getClassCfg();\n      $f = $ccfg['arch'][$this->class_table_index];\n      return !!$this->db->update($ccfg['table'], $data, [$f['id'] => $id]);\n    }\n\n    return false;\n  }",
            "startLine": 117,
            "endLine": 134,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 3,
            "numberOfRequiredParameters": 2,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "data",
                    "position": 1,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "addCfg",
                    "position": 2,
                    "type": "bool",
                    "required": false,
                    "has_default": true,
                    "default": false,
                    "default_name": ""
                }
            ]
        },
        "select": {
            "name": "select",
            "summary": "Retrieves a row from the table through its id.",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id)\n  {\n    if ($this->exists($id)) {\n      $f = $this->class_cfg['arch'][$this->class_table_index];\n      if ($arr = $this->db->rselect(\n        $this->class_table, array_values($f), [\n          $f['id'] => $id\n        ]\n      )) {\n        if (!empty($f['cfg']) && !empty($arr[$f['cfg']])) {\n          $cfg = json_decode($arr[$f['cfg']], true);\n          $arr = array_merge($cfg, $arr);\n          unset($arr[$f['cfg']]);\n        }\n\n        return $arr;\n      }\n    }\n\n    return null;\n\n  }",
            "startLine": 144,
            "endLine": 165,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [
                "array",
                null
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "selectAll": {
            "name": "selectAll",
            "summary": "Returns an array of rows from the table for the given conditions.",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(array $cond)\n  {\n    if (!$this->class_table_index) {\n      throw new \\Exception(X::_(\"The table index parameter should be defined\"));\n    }\n\n    $f = $this->class_cfg['arch'][$this->class_table_index];\n    if ($arrs = $this->db->rselectAll($this->class_table, array_values($f), $cond)) {\n      foreach ($arrs as &$arr) {\n        if (!empty($f['cfg']) && !empty($arr[$f['cfg']])) {\n          $cfg = json_decode($arr[$f['cfg']], true);\n          $arr = array_merge($cfg, $arr);\n          unset($arr[$f['cfg']]);\n        }\n      }\n      unset($arr);\n\n      return $arrs;\n    }\n\n    return [];\n  }",
            "startLine": 175,
            "endLine": 196,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [
                "array"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "cond",
                    "position": 0,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "getOptionRoot": {
            "name": "getOptionRoot",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    self::optionalInit();\n    return self::$option_root_id;\n  }",
            "startLine": 145,
            "endLine": 149,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "getAppuiRoot": {
            "name": "getAppuiRoot",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    self::optionalInit();\n    return self::$option_appui_id;\n  }",
            "startLine": 152,
            "endLine": 156,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "getOptionsObject": {
            "name": "getOptionsObject",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    $o = bbn\\Appui\\Option::getInstance();\n    if (!$o) {\n      throw new \\Exception(X::_(\"Impossible to get the options object from class\").' '.__CLASS__);\n    }\n\n    return $o;\n  }",
            "startLine": 159,
            "endLine": 167,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                "bbn\\Appui\\Option"
            ],
            "parent": false,
            "arguments": []
        },
        "getOptionId": {
            "name": "getOptionId",
            "summary": "Returns The option's ID of a category, i.e. direct children of option's root",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return self::getOptionsObject()->fromCode(...self::_treat_args(func_get_args()));\n  }",
            "startLine": 176,
            "endLine": 179,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "getOptionsIds": {
            "name": "getOptionsIds",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return array_flip(\n      array_filter(\n        self::getOptionsObject()->getCodes(...self::_treat_args(func_get_args())), function ($a) {\n          return $a !== null;\n        }\n      )\n    );\n  }",
            "startLine": 182,
            "endLine": 191,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "getOptionsTree": {
            "name": "getOptionsTree",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return ($tree = self::getOptionsObject()->fullTree(...self::_treat_args(func_get_args()))) ? $tree['items'] : [];\n  }",
            "startLine": 194,
            "endLine": 197,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "getOptions": {
            "name": "getOptions",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return self::getOptionsObject()->fullOptions(...self::_treat_args(func_get_args()));\n  }",
            "startLine": 200,
            "endLine": 203,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "getOption": {
            "name": "getOption",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return self::getOptionsObject()->option(...self::_treat_args(func_get_args()));\n  }",
            "startLine": 206,
            "endLine": 209,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "getOptionsTextValue": {
            "name": "getOptionsTextValue",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return ($id = self::getOptionId(...func_get_args())) ? self::getOptionsObject()->textValueOptions($id) : [];\n  }",
            "startLine": 212,
            "endLine": 215,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "getAppuiOptionId": {
            "name": "getAppuiOptionId",
            "summary": "Returns The option's ID of a category, i.e. direct children of option's root",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return self::getOptionsObject()->fromCode(...self::_treat_args(func_get_args(), true));\n  }",
            "startLine": 224,
            "endLine": 227,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                "string",
                null
            ],
            "parent": false,
            "arguments": []
        },
        "getAppuiOptionsIds": {
            "name": "getAppuiOptionsIds",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return array_flip(\n      array_filter(\n        self::getOptionsObject()->getCodes(\n          ...self::_treat_args(func_get_args(), true)\n        ),\n        function ($a) {\n          return $a !== null;\n        }\n      )\n    );\n  }",
            "startLine": 230,
            "endLine": 242,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                "array"
            ],
            "parent": false,
            "arguments": []
        },
        "getAppuiOptionsTree": {
            "name": "getAppuiOptionsTree",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return ($tree = self::getOptionsObject()->fullTree(...self::_treat_args(func_get_args(), true)) ) ? $tree['items'] : [];\n  }",
            "startLine": 245,
            "endLine": 248,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                "array"
            ],
            "parent": false,
            "arguments": []
        },
        "getAppuiOptions": {
            "name": "getAppuiOptions",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return self::getOptionsObject()->fullOptions(...self::_treat_args(func_get_args(), true));\n  }",
            "startLine": 251,
            "endLine": 254,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                "array",
                null
            ],
            "parent": false,
            "arguments": []
        },
        "getAppuiOption": {
            "name": "getAppuiOption",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return self::getOptionsObject()->option(...self::_treat_args(func_get_args(), true));\n  }",
            "startLine": 257,
            "endLine": 260,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                "array",
                null
            ],
            "parent": false,
            "arguments": []
        },
        "getAppuiOptionsTextValue": {
            "name": "getAppuiOptionsTextValue",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return ($id = self::getAppuiOptionId(...func_get_args())) ? self::getOptionsObject()->textValueOptions($id) : [];\n  }",
            "startLine": 263,
            "endLine": 266,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        }
    },
    "properties": null,
    "staticProperties": {
        "default_class_cfg": {
            "table": "bbn_users_emails",
            "tables": {
                "users_emails": "bbn_users_emails",
                "users_emails_aliases": "bbn_users_emails_aliases",
                "users_emails_recipients": "bbn_users_emails_recipients",
                "users_contacts": "bbn_users_contacts",
                "users_contacts_links": "bbn_users_contacts_links"
            },
            "arch": {
                "users_emails": {
                    "id": "id",
                    "id_user": "id_user",
                    "id_folder": "id_folder",
                    "msg_uid": "msg_uid",
                    "msg_unique_id": "msg_unique_id",
                    "date": "date",
                    "id_sender": "id_sender",
                    "subject": "subject",
                    "size": "size",
                    "attachments": "attachments",
                    "flags": "flags",
                    "is_read": "is_read",
                    "id_parent": "id_parent",
                    "id_thread": "id_thread",
                    "external_uids": "external_uids"
                },
                "users_emails_aliases": {
                    "id_account": "id_account",
                    "id_link": "id_link",
                    "main": "main"
                },
                "users_emails_recipients": {
                    "id_email": "id_email",
                    "id_contact_link": "id_contact_link",
                    "type": "type"
                },
                "users_contacts": {
                    "id": "id",
                    "id_user": "id_user",
                    "name": "name",
                    "blacklist": "blacklist",
                    "cfg": "cfg"
                },
                "users_contacts_links": {
                    "id": "id",
                    "id_contact": "id_contact",
                    "type": "type",
                    "value": "value",
                    "num_sent": "num_sent",
                    "last_sent": "last_sent"
                }
            }
        },
        "optional_is_init": false,
        "option_root_id": null,
        "option_appui_id": null
    },
    "constants": null,
    "numMethods": 65,
    "numProperties": 0,
    "numConstants": 0,
    "numStaticProperties": 4,
    "interfaceNames": [],
    "isInterface": false,
    "traitNames": [
        "bbn\\Models\\Tts\\Dbconfig",
        "bbn\\Models\\Tts\\Optional"
    ],
    "traitAliases": [],
    "isTrait": false,
    "isAbstract": false,
    "isFinal": false,
    "modifiers": 0,
    "parentClass": "bbn\\Models\\Cls\\Basic",
    "isSubclassOf": false,
    "defaultProperties": {
        "default_class_cfg": {
            "table": "bbn_users_emails",
            "tables": {
                "users_emails": "bbn_users_emails",
                "users_emails_aliases": "bbn_users_emails_aliases",
                "users_emails_recipients": "bbn_users_emails_recipients",
                "users_contacts": "bbn_users_contacts",
                "users_contacts_links": "bbn_users_contacts_links"
            },
            "arch": {
                "users_emails": {
                    "id": "id",
                    "id_user": "id_user",
                    "id_folder": "id_folder",
                    "msg_uid": "msg_uid",
                    "msg_unique_id": "msg_unique_id",
                    "date": "date",
                    "id_sender": "id_sender",
                    "subject": "subject",
                    "size": "size",
                    "attachments": "attachments",
                    "flags": "flags",
                    "is_read": "is_read",
                    "id_parent": "id_parent",
                    "id_thread": "id_thread",
                    "external_uids": "external_uids"
                },
                "users_emails_aliases": {
                    "id_account": "id_account",
                    "id_link": "id_link",
                    "main": "main"
                },
                "users_emails_recipients": {
                    "id_email": "id_email",
                    "id_contact_link": "id_contact_link",
                    "type": "type"
                },
                "users_contacts": {
                    "id": "id",
                    "id_user": "id_user",
                    "name": "name",
                    "blacklist": "blacklist",
                    "cfg": "cfg"
                },
                "users_contacts_links": {
                    "id": "id",
                    "id_contact": "id_contact",
                    "type": "type",
                    "value": "value",
                    "num_sent": "num_sent",
                    "last_sent": "last_sent"
                }
            }
        },
        "optional_is_init": false,
        "option_root_id": null,
        "option_appui_id": null,
        "mboxes": [],
        "user": null,
        "pref": null,
        "opt": null,
        "pw": null,
        "errors": [],
        "error": false,
        "debug": false,
        "log": [],
        "_is_init_class_cfg": false,
        "fields": null,
        "class_table": null,
        "class_table_index": null,
        "options": null
    },
    "isIterable": false,
    "extensionName": false,
    "namespaceName": "bbn\\User",
    "shortName": "Email",
    "summary": ""
}