{
    "doc": {
        "description": "",
        "tags": []
    },
    "name": "bbn\\User\\Email",
    "namespace": true,
    "traits": [
        "bbn\\Models\\Tts\\Dbconfig",
        "bbn\\Models\\Tts\\Optional"
    ],
    "interfaces": [],
    "fileName": "\/User\/Email.php",
    "startLine": 17,
    "endLine": 1526,
    "numMethods": 85,
    "numProperties": 0,
    "numConstants": 0,
    "numStaticProperties": 4,
    "interfaceNames": [],
    "isInterface": false,
    "traitNames": [
        "bbn\\Models\\Tts\\Dbconfig",
        "bbn\\Models\\Tts\\Optional"
    ],
    "traitAliases": [],
    "isTrait": false,
    "isAbstract": false,
    "isFinal": false,
    "modifiers": 0,
    "parentClass": "bbn\\Models\\Cls\\Basic",
    "isSubclassOf": false,
    "defaultProperties": {
        "default_class_cfg": {
            "table": "bbn_users_emails",
            "tables": {
                "users_emails": "bbn_users_emails",
                "users_emails_aliases": "bbn_users_emails_aliases",
                "users_emails_recipients": "bbn_users_emails_recipients",
                "users_contacts": "bbn_users_contacts",
                "users_contacts_links": "bbn_users_contacts_links"
            },
            "arch": {
                "users_emails": {
                    "id": "id",
                    "id_user": "id_user",
                    "id_folder": "id_folder",
                    "msg_uid": "msg_uid",
                    "msg_unique_id": "msg_unique_id",
                    "date": "date",
                    "id_sender": "id_sender",
                    "subject": "subject",
                    "excerpt": "excerpt",
                    "size": "size",
                    "attachments": "attachments",
                    "flags": "flags",
                    "is_read": "is_read",
                    "id_parent": "id_parent",
                    "id_thread": "id_thread",
                    "external_uids": "external_uids"
                },
                "users_emails_aliases": {
                    "id_account": "id_account",
                    "id_link": "id_link",
                    "main": "main"
                },
                "users_emails_recipients": {
                    "id_email": "id_email",
                    "id_contact_link": "id_contact_link",
                    "type": "type"
                },
                "users_contacts": {
                    "id": "id",
                    "id_user": "id_user",
                    "name": "name",
                    "blacklist": "blacklist",
                    "cfg": "cfg"
                },
                "users_contacts_links": {
                    "id": "id",
                    "id_contact": "id_contact",
                    "type": "type",
                    "value": "value",
                    "num_sent": "num_sent",
                    "last_sent": "last_sent"
                }
            }
        },
        "optional_is_init": false,
        "option_root_id": null,
        "option_appui_id": null,
        "mboxes": [],
        "opt": null,
        "pw": null,
        "errors": [],
        "error": false,
        "debug": false,
        "log": [],
        "_is_init_class_cfg": false,
        "fields": null,
        "class_cfg": null,
        "class_table": null,
        "class_table_index": null,
        "options": null
    },
    "isIterable": false,
    "extensionName": false,
    "namespaceName": "bbn\\User",
    "shortName": "Email",
    "contentConstructor": {
        "file": "bbn\\User\\Email",
        "returns": []
    },
    "methods": {
        "getFolderTypes": {
            "name": "getFolderTypes",
            "summary": "Returns a list typical folder types as they are recorded in the options",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return self::getOptions('folders');\r\n  }",
            "startLine": 95,
            "endLine": 98,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                "array"
            ],
            "parent": false,
            "arguments": []
        },
        "getAccountTypes": {
            "name": "getAccountTypes",
            "summary": "Returns a list of typical email accounts types as they are recorded in the options",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return self::getOptions('types');\r\n  }",
            "startLine": 106,
            "endLine": 109,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                "array"
            ],
            "parent": false,
            "arguments": []
        },
        "__construct": {
            "name": "__construct",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(bbn\\Db $db, bbn\\User $user = NULL, bbn\\User\\Preferences $pref = NULL)\n  {\n    \/** @var user The user object *\/\r\n    protected ?User $user = null,\r\n    \/** @var preferences The preferences object *\/\r\n    protected ?Preferences $pref = null\r\n  )\r\n  {\r\n    self::optionalInit();\r\n    $this->_init_class_cfg();\r\n    if (!$this->user) {\r\n      $this->user = User::getInstance();\r\n    }\r\n\r\n    if (!$this->pref) {\r\n      $this->pref = Preferences::getInstance();\r\n    }\r\n  }",
            "startLine": 112,
            "endLine": 129,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 3,
            "numberOfRequiredParameters": 1,
            "returns": [],
            "parent": false,
            "arguments": [
                {
                    "name": "db",
                    "position": 0,
                    "type": "bbn\\Db",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "user",
                    "position": 1,
                    "type": "bbn\\User",
                    "required": false,
                    "has_default": true,
                    "default": null,
                    "default_name": ""
                },
                {
                    "name": "pref",
                    "position": 2,
                    "type": "bbn\\User\\Preferences",
                    "required": false,
                    "has_default": true,
                    "default": null,
                    "default_name": ""
                }
            ]
        },
        "getMailbox": {
            "name": "getMailbox",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(string $id_account)\n  {\n    if (!isset($this->mboxes[$id_account])) {\r\n      $this->getAccount($id_account);\r\n    }\r\n\r\n    if (isset($this->mboxes[$id_account])) {\r\n      $mb = &$this->mboxes[$id_account];\r\n      if (!isset($mb['mailbox'])) {\r\n        $cfg = $this->mboxes[$id_account];\r\n        $cfg['pass'] = $this->_get_password()->userGet($id_account, $this->user);\r\n        $mb['mailbox'] = new Mailbox($cfg);\r\n      }\r\n\r\n      if (isset($mb['mailbox'])) {\r\n        return $mb['mailbox'];\r\n      }\r\n    }\r\n\r\n    return null;\r\n\r\n  }",
            "startLine": 132,
            "endLine": 153,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [
                null,
                "bbn\\Appui\\Mailbox"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id_account",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "getAccountsIds": {
            "name": "getAccountsIds",
            "summary": "Returns the list of the accounts' IDs of the current user.",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    if ($id_accounts = self::getOptionId('accounts')) {\r\n      return $this->pref->retrieveIds($id_accounts);\r\n    }\r\n\r\n    return null;\r\n  }",
            "startLine": 162,
            "endLine": 169,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                null,
                "array"
            ],
            "parent": false,
            "arguments": []
        },
        "getAccounts": {
            "name": "getAccounts",
            "summary": "Returns the list of the accounts of the current user.",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(bool $force = false)\n  {\n    $res = [];\r\n    if ($ids = $this->getAccountsIds()) {\r\n      foreach ($ids as $id) {\r\n        $res[] = $this->getAccount($id, $force);\r\n      }\r\n    }\r\n\r\n    return $res;\r\n  }",
            "startLine": 178,
            "endLine": 188,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 0,
            "returns": [
                "array"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "force",
                    "position": 0,
                    "type": "bool",
                    "required": false,
                    "has_default": true,
                    "default": false,
                    "default_name": ""
                }
            ]
        },
        "setAccountStage": {
            "name": "setAccountStage",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(string $id_account, int $stage)\n  {\n    $a = $this->pref->get($id_account);\r\n    if ($a) {\r\n      $a['stage'] = $stage;\r\n      return $this->pref->set($id_account, $a);\r\n    }\r\n\r\n    return false;\r\n  }",
            "startLine": 191,
            "endLine": 200,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 2,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id_account",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "stage",
                    "position": 1,
                    "type": "int",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "getAccount": {
            "name": "getAccount",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(string $id_account, bool $force = false)\n  {\n    if ($force || !isset($this->mboxes[$id_account])) {\r\n      if ($a = $this->pref->get($id_account)) {\r\n        $this->mboxes[$id_account] = [\r\n          'id' => $a['id'],\r\n          'host' => $a['host'] ?? null,\r\n          'login' => $a['login'],\r\n          'type' => $a['type'],\r\n          'port' => $a['port'] ?? null,\r\n          'ssl' => $a['ssl'] ?? true,\r\n          'folders' => null,\r\n          'last_uid' => $a['last_uid'] ?? null,\r\n          'last_check' => $a['last_check'] ?? null,\r\n          'id_account' => $id_account\r\n        ];\r\n        $this->mboxes[$id_account]['folders'] = $this->getFolders($this->mboxes[$id_account]);\r\n        if (!isset($a['stage'])) {\r\n          $a['stage'] = 1;\r\n          $this->pref->set($id_account, $a);\r\n        }\r\n        $this->mboxes[$id_account]['stage'] = $a['stage'];\r\n      }\r\n    }\r\n    return $this->mboxes[$id_account] ?? null;\r\n  }",
            "startLine": 202,
            "endLine": 227,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 1,
            "returns": [
                null,
                "array"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id_account",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "force",
                    "position": 1,
                    "type": "bool",
                    "required": false,
                    "has_default": true,
                    "default": false,
                    "default_name": ""
                }
            ]
        },
        "checkConfig": {
            "name": "checkConfig",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($cfg)\n  {\n    if (X::hasProps($cfg, ['login', 'pass', 'type'], true)) {\r\n      $mb = new Mailbox($cfg);\r\n      return $mb->check();\r\n    }\r\n    return false;\r\n  }",
            "startLine": 230,
            "endLine": 237,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "cfg",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "updateAccount": {
            "name": "updateAccount",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(string $id_account, array $cfg)\n  {\n    if (X::hasProps($cfg, ['login', 'pass', 'type'], true)\r\n      && ($acc = $this->getAccount($id_account))\r\n      && ($this->pref->setCfg(\r\n        $id_account,\r\n        [\r\n          'host' => $cfg['host'] ?? null,\r\n          'login' => $cfg['login'],\r\n          'type' => $cfg['type'],\r\n          'port' => $cfg['port'] ?? null,\r\n          'ssl' => $cfg['ssl'] ?? true,\r\n          'last_uid' => $cfg['last_uid'] ?? null,\r\n          'last_check' => $cfg['last_check'] ?? null\r\n        ]\r\n      ))\r\n    ) {\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }",
            "startLine": 240,
            "endLine": 261,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 2,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id_account",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "cfg",
                    "position": 1,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "deleteAccount": {
            "name": "deleteAccount",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(string $id_account)\n  {\n    return (bool)$this->pref->delete($id_account);\r\n  }",
            "startLine": 264,
            "endLine": 267,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id_account",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "addAccount": {
            "name": "addAccount",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(array $cfg)\n  {\n    if (!X::hasProps($cfg, ['login', 'pass', 'type'], true)) {\r\n      throw new \\Exception(\"Missing arguments\");\r\n    }\r\n\r\n    if (!($id_accounts = self::getOptionId('accounts'))) {\r\n      throw new \\Exception(\"Impossible to find the account option\");\r\n    }\r\n\r\n    \/\/ toGroup as this option will use different user options\r\n    if (!($id_pref = $this->pref->addToGroup(\r\n      $id_accounts,\r\n      [\r\n        'id_user' => $this->user->getId(),\r\n        'login' => $cfg['login'],\r\n        'type' => $cfg['type'],\r\n        'host' => $cfg['host'] ?? null,\r\n        'port' => $cfg['port'] ?? null,\r\n        'ssl' => $cfg['ssl'] ?? true\r\n      ]\r\n    ))\r\n    ) {\r\n      throw new \\Exception(\"Impossible to add the preference\");\r\n    }\r\n\r\n    if (!$this->_get_password()->userStore($cfg['pass'], $id_pref, $this->user)) {\r\n      throw new \\Exception(\"Impossible to set the password\");\r\n    }\r\n\r\n    $this->getAccount($id_pref, true);\r\n    if (!empty($cfg['folders'])) {\r\n      $this->syncFolders($id_pref, $cfg['folders']);\r\n    }\r\n\r\n    return $id_pref;\r\n  }",
            "startLine": 270,
            "endLine": 306,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [
                "string"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "cfg",
                    "position": 0,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "reset": {
            "name": "reset",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(string $id_account)\n  {\n    if (($account = $this->getAccount($id_account))\r\n      && ($num = $this->pref->deleteBits($id_account))\r\n    ) {\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }",
            "startLine": 309,
            "endLine": 318,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id_account",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "createFolder": {
            "name": "createFolder",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(string $id_account, string $name, string $id_parent = NULL)\n  {\n    $mb = $this->getMailbox($id_account);\r\n    $uid_parent = \"\";\r\n    if ($id_parent) {\r\n      $uid_parent = $this->getFolder($id_parent)['uid'];\r\n    }\r\n    $mboxName = $id_parent ? $uid_parent . '.' . $name : $name;\r\n    if ($mb && $mb->createMbox($mboxName)) {\r\n      if ($this->createFolderDb($id_account, $name, $id_parent)) {\r\n        $this->mboxes[$id_account]['folders'] = $this->getFolders($this->mboxes[$id_account]);\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }",
            "startLine": 321,
            "endLine": 336,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 3,
            "numberOfRequiredParameters": 2,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id_account",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "name",
                    "position": 1,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "id_parent",
                    "position": 2,
                    "type": "string",
                    "required": false,
                    "has_default": true,
                    "default": null,
                    "default_name": ""
                }
            ]
        },
        "createFolderDb": {
            "name": "createFolderDb",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(string $id_account, string $name, string $id_parent = NULL)\n  {\n    $types = self::getFolderTypes();\r\n\r\n    $a = [\r\n      'id_option' => X::getField($types, ['code' => 'folders'], 'id'),\r\n      'text' => $name,\r\n      'uid' => $name,\r\n      'subscribed' => true\r\n    ];\r\n\r\n    if ($id_parent) {\r\n      $uid_parent = $this->getFolder($id_parent)['uid'];\r\n      $a['uid'] = $uid_parent . '.' . $name;\r\n      $a['id_parent'] = $id_parent;\r\n    }\r\n\r\n    return (bool)$this->pref->addBit($id_account, $a);\r\n  }",
            "startLine": 339,
            "endLine": 357,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 3,
            "numberOfRequiredParameters": 2,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id_account",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "name",
                    "position": 1,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "id_parent",
                    "position": 2,
                    "type": "string",
                    "required": false,
                    "has_default": true,
                    "default": null,
                    "default_name": ""
                }
            ]
        },
        "renameFolder": {
            "name": "renameFolder",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(string $id, string $name, string $id_account, string $id_parent = NULL)\n  {\n    $mb = $this->getMailbox($id_account);\r\n    $uid_parent = \"\";\r\n    if ($id_parent) {\r\n      $uid_parent = $this->getFolder($id_parent)['uid'];\r\n    }\r\n    $mboxName = $id_parent ? $uid_parent . '.' . $name : $name;\r\n    if ($mb && $mb->renameMbox($this->getFolder($id)['uid'], $mboxName)) {\r\n      if ($this->renameFolderDb($id, $name, $id_account, $id_parent)) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }",
            "startLine": 360,
            "endLine": 374,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 4,
            "numberOfRequiredParameters": 3,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "name",
                    "position": 1,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "id_account",
                    "position": 2,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "id_parent",
                    "position": 3,
                    "type": "string",
                    "required": false,
                    "has_default": true,
                    "default": null,
                    "default_name": ""
                }
            ]
        },
        "renameFolderDb": {
            "name": "renameFolderDb",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(string $id, string $name, string $id_account, string $id_parent = NULL)\n  {\n    $a = [\r\n      'text' => $name,\r\n      'uid' => $name,\r\n    ];\r\n\r\n    if ($id_parent) {\r\n      $uid_parent = $this->getFolder($id_parent)['uid'];\r\n      $a['uid'] = $uid_parent . '.' . $name;\r\n      $a['id_parent'] = $id_parent;\r\n    }\r\n    if ($this->pref->updateBit($id, $a)) {\r\n      if (!$id_parent) {\r\n        $this->pref->moveBit($id, null);\r\n      }\r\n      $this->mboxes[$id_account]['folders'] = $this->getFolders($this->mboxes[$id_account]);\r\n      return true;\r\n    };\r\n    return false;\r\n  }",
            "startLine": 377,
            "endLine": 397,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 4,
            "numberOfRequiredParameters": 3,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "name",
                    "position": 1,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "id_account",
                    "position": 2,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "id_parent",
                    "position": 3,
                    "type": "string",
                    "required": false,
                    "has_default": true,
                    "default": null,
                    "default_name": ""
                }
            ]
        },
        "deleteFolder": {
            "name": "deleteFolder",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(string $id, string $id_account)\n  {\n    $mb = $this->getMailbox($id_account);\r\n    $folder = $this->getFolder($id);\r\n    if ($folder && $mb->deleteMbox($folder['uid'])) {\r\n      if ($this->deleteFolderDb($id)) {\r\n        $this->mboxes[$id_account]['folders'] = $this->getFolders($this->mboxes[$id_account]);\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }",
            "startLine": 400,
            "endLine": 411,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 2,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "id_account",
                    "position": 1,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "deleteFolderDb": {
            "name": "deleteFolderDb",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(string $id)\n  {\n    return (bool)$this->pref->deleteBit($id);\r\n  }",
            "startLine": 414,
            "endLine": 417,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "checkFolder": {
            "name": "checkFolder",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(array $folder, $sync = false)\n  {\n    if (X::hasProp($folder, 'uid')\r\n      && ($mb = $this->getMailbox($folder['id_account']))\r\n      && $mb->check()\r\n    ) {\r\n      if ($mb->update($folder['uid'])\r\n        && ($folders = $mb->getFolders())\r\n        && ($res = $folders[$folder['uid']])\r\n        && ($info = $mb->getInfoFolder($folder['uid']))\r\n      ) {\r\n        if (!array_key_exists('db_uid', $res)) {\r\n          $res['db_uid'] = null;\r\n        }\r\n\r\n        if (($res['num_msg'] && !$folder['last_uid']) || ($folder['last_uid'] !== $res['db_uid']) || ($res['num_msg'] !== $info->Nmsgs)) {\r\n          $id_account = $folder['id_account'];\r\n          unset($folder['id_account']);\r\n          $res = array_merge($folder, $res);\r\n          $this->pref->updateBit($folder['id'], $res, true);\r\n          $res['id_account'] = $id_account;\r\n          $this->getAccount($id_account, true);\r\n          if ($sync) {\r\n            \/\/$this->syncEmails($res);\r\n          }\r\n        }\r\n\r\n        return $res;\r\n      }\r\n    }\r\n\r\n    return null;\r\n\r\n  }",
            "startLine": 420,
            "endLine": 453,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 1,
            "returns": [],
            "parent": false,
            "arguments": [
                {
                    "name": "folder",
                    "position": 0,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "sync",
                    "position": 1,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": false,
                    "default_name": ""
                }
            ]
        },
        "getInfoFolder": {
            "name": "getInfoFolder",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id)\n  {\n    $folder = $this->getFolder($id);\r\n    if ($folder) {\r\n      $mb = $this->getMailbox($folder['id_account']);\r\n      if ($mb) {\r\n        return $mb->getInfoFolder($folder['uid']);\r\n      }\r\n    }\r\n    return null;\r\n  }",
            "startLine": 455,
            "endLine": 465,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [],
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "getFolders": {
            "name": "getFolders",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($account, $force = false)\n  {\n    $acc = is_array($account) ? $account : $acc = $this->getAccount($account);\r\n    if ($acc) {\r\n      $types = self::getFolderTypes();\r\n      if ($force) {\r\n        $this->syncFolders($acc['id']);\r\n      }\r\n\r\n      $cfg = $this->class_cfg['arch']['users_emails'];\r\n      $table = $this->class_cfg['tables']['users_emails'];\r\n      return X::map(\r\n        function ($a) use ($types, $cfg, $table) {\r\n          if (!isset($a['uid'])) {\r\n\r\n            \/\/die(X::dump(\"NO UID\", $a, debug_backtrace()));\r\n          }\r\n\r\n          $res = [\r\n            'id' => $a['id'],\r\n            'id_account' => $a['id_user_option'],\r\n            'text' => $a['text'],\r\n            'uid' => $a['uid'],\r\n            'id_option' => $a['id_option'],\r\n            'id_parent' => $a['id_parent'] ?? null,\r\n            'type' => X::getField($types, ['id' => $a['id_option']], 'code'),\r\n            'db_uid_max' => $this->db->selectOne(\r\n              $table,\r\n              'MAX(' . $this->db->csn($cfg['msg_uid'], true) . ')',\r\n              [\r\n                $cfg['id_folder'] => $a['id'],\r\n                $cfg['id_user'] => $this->user->getId()\r\n              ]\r\n            ),\r\n            'db_uid_min' => $this->db->selectOne(\r\n              $table,\r\n              'MIN(' . $this->db->csn($cfg['msg_uid'], true) . ')',\r\n              [\r\n                $cfg['id_folder'] => $a['id'],\r\n                $cfg['id_user'] => $this->user->getId()\r\n              ]\r\n            ),\r\n            'num_msg' => $this->db->count($table, [$cfg['id_folder'] => $a['id']]),\r\n            'last_uid' => $a['last_uid'] ?? null,\r\n            'last_check' => $a['last_check'] ?? null,\r\n            'hash' => $a['hash'] ?? null,\r\n            'subscribed' => $a['subscribed'] ?? false\r\n          ];\r\n          if (!empty($a['items'])) {\r\n            $res['items'] = $a['items'];\r\n          }\r\n\r\n          return $res;\r\n        },\r\n        $this->pref->getFullBits($acc['id']),\r\n        'items'\r\n      );\r\n    }\r\n\r\n    return null;\r\n  }",
            "startLine": 468,
            "endLine": 528,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 1,
            "returns": [],
            "parent": false,
            "arguments": [
                {
                    "name": "account",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "force",
                    "position": 1,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": false,
                    "default_name": ""
                }
            ]
        },
        "flattenFolders": {
            "name": "flattenFolders",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($folders)\n  {\n    $res = [];\r\n    foreach ($folders as $f) {\r\n      if (!empty($f['items']) && is_array($f['items']) && count($f['items'])) {\r\n        $res = array_merge($res, $this->flattenFolders($f['items']));\r\n      }\r\n      $res[] = $f;\r\n    }\r\n    return $res;\r\n  }",
            "startLine": 530,
            "endLine": 540,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [
                "array"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "folders",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "getHashes": {
            "name": "getHashes",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    $res = [];\r\n    $account_hash = \"\";\r\n    foreach ($this->getAccounts() as $a) {\r\n      $res[$a['id']] = [\r\n        'hash' => \"\",\r\n        'folders' => []\r\n      ];\r\n      $folders = $this->flattenFolders($this->getFolders($a['id']));\r\n      foreach ($folders as $f) {\r\n        $res[$a['id']]['folders'][$f['id']] = $f['hash'];\r\n        if ($f['hash']) {\r\n          $account_hash .= $f['hash'];\r\n        } else {\r\n          $account_hash .= $f['id'];\r\n        }\r\n      }\r\n      $res[$a['id']]['hash'] = md5($account_hash);\r\n    }\r\n    return $res;\r\n  }",
            "startLine": 542,
            "endLine": 563,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                null,
                "array"
            ],
            "parent": false,
            "arguments": []
        },
        "getFolder": {
            "name": "getFolder",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(string $id, bool $force = false)\n  {\n    $types = self::getFolderTypes();\r\n    $cfg = $this->class_cfg['arch']['users_emails'];\r\n    $table = $this->class_cfg['tables']['users_emails'];\r\n    $a = $this->pref->getBit($id);\r\n    if ($a) {\r\n      return [\r\n        'id' => $a['id'],\r\n        'id_account' => $a['id_user_option'],\r\n        'text' => $a['text'],\r\n        'uid' => $a['uid'],\r\n        'id_option' => $a['id_option'],\r\n        'type' => X::getField($types, ['id' => $a['id_option']], 'code'),\r\n        'db_uid_max' => $this->db->selectOne(\r\n          $table,\r\n          'MAX(' . $this->db->csn($cfg['msg_uid'], true) . ')',\r\n          [\r\n            $cfg['id_folder'] => $a['id'],\r\n            $cfg['id_user'] => $this->user->getId()\r\n          ]\r\n        ),\r\n        'db_uid_min' => $this->db->selectOne(\r\n          $table,\r\n          'MIN(' . $this->db->csn($cfg['msg_uid'], true) . ')',\r\n          [\r\n            $cfg['id_folder'] => $a['id'],\r\n            $cfg['id_user'] => $this->user->getId()\r\n          ]\r\n        ),\r\n        'num_msg' => $this->db->count($table, [$cfg['id_folder'] => $id]),\r\n        'last_uid' => $a['last_uid'] ?? null,\r\n        'last_check' => $a['last_check'] ?? null,\r\n        'hash' => $a['hash'] ?? null\r\n      ];\r\n    }\r\n\r\n    return null;\r\n  }",
            "startLine": 565,
            "endLine": 603,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 1,
            "returns": [
                null,
                "array"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "force",
                    "position": 1,
                    "type": "bool",
                    "required": false,
                    "has_default": true,
                    "default": false,
                    "default_name": ""
                }
            ]
        },
        "getNextUid": {
            "name": "getNextUid",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(array $folder, int $uid)\n  {\n    $mb = $this->getMailbox($folder['id_account']);\r\n    $mb->selectFolder($folder['uid']);\r\n    return $mb->getNextUid($uid);\r\n  }",
            "startLine": 605,
            "endLine": 610,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 2,
            "returns": [
                null,
                "int"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "folder",
                    "position": 0,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "uid",
                    "position": 1,
                    "type": "int",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "syncEmails": {
            "name": "syncEmails",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(array $folder, int $limit = 0)\n  {\n  {\r\n    \/\/ log pid\r\n    $pid = getmypid();\r\n    X::log([\r\n      'pid' => $pid,\r\n      'folder' => $folder\r\n    ], 'pid');\r\n\r\n    if (X::hasProps($folder, ['id', 'id_account', 'last_uid', 'uid'])) {\r\n      X::log($folder, 'monreuf');\r\n      $res = 0;\r\n      $mb = $this->getMailbox($folder['id_account']);\r\n      $info = $mb->getInfoFolder($folder['uid']);\r\n      $mb->selectFolder($folder['uid']);\r\n\r\n      if (!empty($folder['last_uid'])) {\r\n        $first_uid = $mb->getFirstUid();\r\n        $last_uid = $mb->getLastUid();\r\n        $start = null;\r\n        $real_end = null;\r\n\r\n        if (isset($folder['db_uid_min']) && isset($folder['db_uid_max'])) {\r\n          if ($folder['db_uid_min'] == $first_uid && $folder['db_uid_max'] == $last_uid) {\r\n            return 0;\r\n          }\r\n\r\n          if ($folder['db_uid_max'] != $last_uid) {\r\n            $start = $last_uid;\r\n            $real_end = $mb->getNextUid($folder['db_uid_max']);\r\n          } else if ($folder['db_uid_min'] != $first_uid) {\r\n            $test = $folder['db_uid_min'];\r\n            $start = $folder['db_uid_min'];\r\n            $real_end = $start - $limit;\r\n            if ($real_end < 1) {\r\n              $real_end = $first_uid;\r\n            }\r\n            try {\r\n              if ($mb->getMsgNo($real_end) < $first_uid) {\r\n                $real_end = $first_uid;\r\n              }\r\n            } catch (\\Exception $e) {\r\n              $real_end = $first_uid;\r\n            }\r\n\r\n          }\r\n        }\r\n        else {\r\n          $start = $last_uid;\r\n          $real_end = $start - $limit;\r\n\r\n          if ($real_end < 1) {\r\n            $real_end = $first_uid;\r\n          }\r\n          try {\r\n            if ($mb->getMsgNo($real_end) < $first_uid) {\r\n              $real_end = $first_uid;\r\n            }\r\n          } catch (\\Exception $e) {\r\n            $real_end = $first_uid;\r\n          }\r\n        }\r\n\r\n        $log = false;\r\n\r\n        if (!$start || !$real_end) {\r\n          X::log(\"start: $start, real_end: $real_end, first_uid: $first_uid, last_uid: $last_uid\", 'poller_email_error');\r\n          $log = true;\r\n        }\r\n\r\n        try {\r\n          $start = $mb->getMsgNo($start);\r\n          $real_end = $mb->getMsgNo($real_end);\r\n        } catch (\\Exception $e) {\r\n          $start = $mb->getMsgNo($last_uid);\r\n          $real_end = $mb->getMsgNo($first_uid);\r\n\r\n          if ($folder['db_uid_min'] && $folder['db_uid_max'] == $last_uid) {\r\n            $start = $folder['db_uid_min'];\r\n          } else if ($folder['db_uid_max'] != $last_uid) {\r\n            $start = $last_uid;\r\n            $real_end = $mb->getNextUid($folder['db_uid_max']);\r\n          }\r\n        }\r\n\r\n        if ($log) {\r\n          X::log(\"sstart: $start, real_end: $real_end, first_uid: $first_uid, last_uid: $last_uid\", 'poller_email_error');\r\n        }\r\n\r\n        if (!$start || !$real_end) {\r\n          return 0;\r\n        }\r\n\r\n\r\n        $end = $start;\r\n        $all = $mb->getEmailsList($folder, $start, $real_end);\r\n        if ($all) {\r\n          \/\/var_dump($start, $end);\r\n          foreach ($all as $a) {\r\n            X::log($all);\r\n            if ($this->insertEmail($folder, $a)) {\r\n              $a = $this->pref->get($folder['id_account']);\r\n              if ($a) {\r\n                if (!$a['sync']) {\r\n                  $a['sync'] = [];\r\n                }\r\n                if (!isset($a['sync']['folders'])) {\r\n                  $a['sync']['folders'] = [];\r\n                }\r\n                $cfg = $this->class_cfg['arch']['users_emails'];\r\n                $table = $this->class_cfg['tables']['users_emails'];\r\n                $a['sync']['folders'][$folder['id']] = [\r\n                  'id' => $folder['id'],\r\n                  'name' => $folder['uid'],\r\n                  'db_msg' => $this->db->count($table, [$cfg['id_folder'] => $folder['id']]),\r\n                  'msg' => $info->Nmsgs,\r\n                ];\r\n                $this->pref->set($folder['id_account'], $a);\r\n              }\r\n              $res++;\r\n            } else {\r\n              \/\/throw new \\Exception(X::_(\"Impossible to insert the email with ID\").' '.$a['message_id']);\r\n              $this->log(X::_(\"Impossible to insert the email with ID\") . ' ' . $a['message_id']);\r\n            }\r\n          }\r\n\r\n          $hash = md5(json_encode(['numMsg' => $folder['num_msg'], 'lastUid' => $folder['last_uid']]));\r\n          $this->pref->updateBit($folder['id'], [\r\n            'last_check' => date('Y-m-d H:i:s'),\r\n            'hash' => $hash\r\n          ], true);\r\n        } else {\r\n          X::log(X::_(\"Impossible to get the emails for folder\") . ' ' . $folder['uid'] . ' ' . X::_(\"from\") . ' ' . $start . ' ' . X::_(\"to\") . ' ' . $end . ' (' . $real_end . ')');\r\n          throw new \\Exception(\r\n            X::_(\"Impossible to get the emails for folder\")\r\n            . ' ' . $folder['uid']\r\n            . ' ' . X::_(\"from\") . ' ' . $start\r\n            . ' ' . X::_(\"to\") . ' ' . $end\r\n            . ' (' . $real_end . ')'\r\n          );\r\n        }\r\n      } else {\r\n        $a = $this->pref->get($folder['id_account']);\r\n        if ($a) {\r\n          if (!$a['sync']) {\r\n            $a['sync'] = [];\r\n          }\r\n          if (!isset($a['sync']['folders'])) {\r\n            $a['sync']['folders'] = [];\r\n          }\r\n          $cfg = $this->class_cfg['arch']['users_emails'];\r\n          $table = $this->class_cfg['tables']['users_emails'];\r\n          $a['sync']['folders'][$folder['id']] = [\r\n            'id' => $folder['id'],\r\n            'name' => $folder['uid'],\r\n            'db_msg' => $this->db->count($table, [$cfg['id_folder'] => $folder['id']]),\r\n            'msg' => $info->Nmsgs,\r\n          ];\r\n          $this->pref->set($folder['id_account'], $a);\r\n        }\r\n      }\r\n\r\n      if ($info->Nmsgs > ($res + $folder['num_msg'])) {\r\n        $cfg = $this->class_cfg['arch']['users_emails'];\r\n        $table = $this->class_cfg['tables']['users_emails'];\r\n        $num = $res + $folder['num_msg'];\r\n        $s2 = 0;\r\n\r\n        while ($info->Nmsgs < $num) {\r\n          $msg = $this->db->rselect($table, [$cfg['id'], $cfg['msg_uid']], [$cfg['id_folder'] => $folder['id']], [$cfg['msg_uid'] => 'DESC'], $s2);\r\n          if (!$mb->getMsgNo($msg['msg_uid'])) {\r\n            if ($this->db->delete($table, [$cfg['id'] => $msg['id']])) {\r\n              $num--;\r\n              $s2--;\r\n            }\r\n          }\r\n          $s2++;\r\n        }\r\n      }\r\n      return $res;\r\n    }\r\n\r\n    return null;\r\n  }",
            "startLine": 612,
            "endLine": 796,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 1,
            "returns": [
                null,
                "int"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "folder",
                    "position": 0,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "limit",
                    "position": 1,
                    "type": "int",
                    "required": false,
                    "has_default": true,
                    "default": 0,
                    "default_name": ""
                }
            ]
        },
        "getLastUid": {
            "name": "getLastUid",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($folder)\n  {\n    $mb = $this->getMailbox($folder['id_account']);\r\n    $mb->selectFolder($folder['uid']);\r\n    return $mb->getLastUid();\r\n  }",
            "startLine": 798,
            "endLine": 803,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [],
            "parent": false,
            "arguments": [
                {
                    "name": "folder",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "getFirstUid": {
            "name": "getFirstUid",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($folder)\n  {\n    $mb = $this->getMailbox($folder['id_account']);\r\n    $mb->selectFolder($folder['uid']);\r\n    return $mb->getFirstUid();\r\n  }",
            "startLine": 805,
            "endLine": 810,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [],
            "parent": false,
            "arguments": [
                {
                    "name": "folder",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "getList": {
            "name": "getList",
            "summary": "Returns a list of emails based on their folder.",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(string $id_folder, array $post)\n  {\n    if ($ids = $this->idsFromFolder($id_folder)) {\r\n      $cfg = $this->class_cfg['arch']['users_emails'];\r\n      $table = $this->class_cfg['tables']['users_emails'];\r\n      $real_filter = [\r\n        'logic' => 'AND',\r\n        'conditions' => [\r\n          $cfg['id_folder'] => $ids\r\n        ]\r\n      ];\r\n      if (!empty($post['filters'])) {\r\n        if (!isset($post['filters']['conditions'])) {\r\n          $post['filters'] = ['conditions' => $post['filters']];\r\n        }\r\n\r\n        if (!empty($post['filters']['conditions'])) {\r\n          $real_filter['conditions'][] = $post['filters'];\r\n        }\r\n      }\r\n\r\n      $post['filters'] = $real_filter;\r\n      $grid = new \\bbn\\Appui\\Grid($this->db, $post, [\r\n        'table' => $table,\r\n        'fields' => $cfg\r\n      ]);\r\n\r\n\r\n      if ($grid->check()) {\r\n        return $grid->getDatatable();\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }",
            "startLine": 823,
            "endLine": 857,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 2,
            "returns": [
                null,
                "array"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id_folder",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": "",
                    "description": "folder"
                },
                {
                    "name": "post",
                    "position": 1,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "getLoginByEmailId": {
            "name": "getLoginByEmailId",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id)\n  {\n    $cfg = $this->class_cfg['arch']['users_emails'];\r\n    $table = $this->class_cfg['tables']['users_emails'];\r\n    $em = $this->db->rselect($table, $cfg, [$cfg['id'] => $id]);\r\n    if ($em) {\r\n      $folder = $this->getFolder($em['id_folder']);\r\n      if ($folder\r\n        && ($mb = $this->getAccount($folder['id_account']))) {\r\n        return $mb;\r\n      }\r\n    }\r\n    return null;\r\n  }",
            "startLine": 860,
            "endLine": 873,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [],
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "getEmail": {
            "name": "getEmail",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id)\n  {\n    $cfg = $this->class_cfg['arch']['users_emails'];\r\n    $table = $this->class_cfg['tables']['users_emails'];\r\n    $em = $this->db->rselect($table, $cfg, [$cfg['id'] => $id]);\r\n    if ($em) {\r\n      $folder = $this->getFolder($em['id_folder']);\r\n      if ($folder\r\n        && ($mb = $this->getMailbox($folder['id_account']))\r\n        && $mb->selectFolder($folder['uid'])\r\n        && Str::isInteger($number = $mb->getMsgNo($em['msg_uid']))\r\n      ) {\r\n        if ($number === 0) {\r\n          $this->db->delete($table, [$cfg['id'] => $id]);\r\n          return null;\r\n        }\r\n        $arr = $mb->getMsg($number, $id, $folder['id_account']);\r\n        $arr['id_account'] = $folder['id_account'];\r\n        $arr['msg_unique_id'] = $em['msg_unique_id'];\r\n        return $arr;\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }",
            "startLine": 875,
            "endLine": 899,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [
                null,
                "array"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "getEmailByUID": {
            "name": "getEmailByUID",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($post)\n  {\n    $cfg = $this->class_cfg['arch']['users_emails'];\r\n    $table = $this->class_cfg['tables']['users_emails'];\r\n\r\n    $grid = new \\bbn\\Appui\\Grid($this->db, $post, [\r\n      'table' => $table,\r\n      'fields' => $cfg\r\n    ]);\r\n\r\n    if ($grid->check()) {\r\n      return $grid->getDatatable();\r\n    }\r\n\r\n    return null;\r\n  }",
            "startLine": 901,
            "endLine": 916,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [
                null,
                "array"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "post",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "getThreadId": {
            "name": "getThreadId",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(string $id)\n  {\n    if ($id === null) {\r\n      return null;\r\n    }\r\n    $cfg = $this->class_cfg['arch']['users_emails'];\r\n    $table = $this->class_cfg['tables']['users_emails'];\r\n\r\n    $email = $this->db->rselect([\r\n      'table' => $table,\r\n      'fields' => $cfg,\r\n      'where' => [\r\n        'conditions' => [\r\n          $cfg['id'] => $id\r\n        ]\r\n      ]\r\n    ]);\r\n\r\n    while ($email['id_parent']) {\r\n      $email = $this->db->rselect([\r\n        'table' => $table,\r\n        'fields' => $cfg,\r\n        'where' => [\r\n          'conditions' => [\r\n            $cfg['id'] => $email['id_parent']\r\n          ]\r\n        ]\r\n      ]);\r\n    }\r\n\r\n    return $email['thread_id'];\r\n\r\n  }",
            "startLine": 918,
            "endLine": 950,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [
                null,
                "string"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "updateRead": {
            "name": "updateRead",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id)\n  {\n    $cfg = $this->class_cfg['arch']['users_emails'];\r\n    $table = $this->class_cfg['tables']['users_emails'];\r\n    $this->db->update($table, [$cfg['is_read'] => 1], [$cfg['id'] => $id]);\r\n  }",
            "startLine": 952,
            "endLine": 957,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [],
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "syncThreads": {
            "name": "syncThreads",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(int $limit)\n  {\n    $cfg = $this->class_cfg['arch']['users_emails'];\r\n    $table = $this->class_cfg['tables']['users_emails'];\r\n\r\n    \/\/ select all emails of the user where id_thread is null and external_id is not null\r\n    $emails = $this->db->rselectAll([\r\n      'table' => $table,\r\n      'fields' => $cfg,\r\n      'where' => [\r\n        'logic' => 'AND',\r\n        'conditions' => [\r\n          [\r\n            'field' => $cfg['id_user'],\r\n            'value' => $this->user->getId()\r\n          ],\r\n        ]\r\n      ],\r\n      'order' => [\r\n        'field' => $cfg['date']\r\n      ]\r\n    ]);\r\n\r\n  }",
            "startLine": 959,
            "endLine": 982,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [],
            "parent": false,
            "arguments": [
                {
                    "name": "limit",
                    "position": 0,
                    "type": "int",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "insertEmail": {
            "name": "insertEmail",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(array $folder, array $email)\n  {\n    $id = false;\r\n    if (X::hasProps($email, ['from', 'uid'])) {\r\n      $cfg = $this->class_cfg['arch']['users_emails'];\r\n      $table = $this->class_cfg['tables']['users_emails'];\r\n      $existing = $this->db->selectOne(\r\n        $table,\r\n        $cfg['id'],\r\n        [\r\n          $cfg['id_user'] => $this->user->getId(),\r\n          $cfg['msg_uid'] => $email['uid'],\r\n          $cfg['id_folder'] => $folder['id']\r\n        ]\r\n      );\r\n      $uid = $email['uid'];\r\n      X::log(\"$existing => $uid\", 'existing');\r\n      foreach (Mailbox::getDestFields() as $df) {\r\n        if (!empty($email[$df])) {\r\n          foreach ($email[$df] as &$dest) {\r\n            if ($id = $this->retrieveEmail($dest['email'])) {\r\n              $sent_opt = X::getField(self::getFolderTypes(), ['code' => 'sent'], 'id');\r\n              if ($sent_opt === $folder['id_option']) {\r\n                $this->addSentToLink($id, Date('Y-m-d H:i:s', strtotime($email['date'])));\r\n              }\r\n            } elseif (!($id = $this->addContactFromMail($dest))) {\r\n              X::log(\"Impossible to add contact from mail\" . $dest['email'], 'poller_email_error');\r\n            }\r\n\r\n            $dest['id'] = $id;\r\n          }\r\n\r\n          if ($df === 'from') {\r\n            $id_sender = $id;\r\n          }\r\n        }\r\n      }\r\n\r\n\r\n      if (!empty($id_sender)) {\r\n        $id_parent = null;\r\n        $id_thread = null;\r\n\r\n        \/\/die(var_dump($email));\r\n        $external = null;\r\n        if (!empty($email['in_reply_to']) || !empty($email['references'])) {\r\n          $external = [\r\n            'in_reply_to' => $email['in_reply_to'] ?? null,\r\n            'references' => $email['references'] ?? null\r\n          ];\r\n        }\r\n\r\n        if ($email['priority']) {\r\n          \/\/ if Flagged dont contains none of the priority flag, add it\r\n          if (!str_contains($email['Flagged'], 'Highest')\r\n            && !str_contains($email['Flagged'], 'High')\r\n            && !str_contains($email['Flagged'], 'Normal')\r\n            && !str_contains($email['Flagged'], 'Low')\r\n            && !str_contains($email['Flagged'], 'Lowest')\r\n          ) {\r\n            switch ($email['priority']) {\r\n              case 1:\r\n                $email['Flagged'] .= ' Highest';\r\n                break;\r\n              case 2:\r\n                $email['Flagged'] .= ' High';\r\n                break;\r\n              case 3:\r\n                $email['Flagged'] .= ' Normal';\r\n                break;\r\n              case 4:\r\n                $email['Flagged'] .= ' Low';\r\n                break;\r\n              case 5:\r\n                $email['Flagged'] .= ' Lowest';\r\n                break;\r\n            }\r\n            \/\/ trim the space if is in first position\r\n            if (str_starts_with($email['Flagged'], ' ')) {\r\n              $email['Flagged'] = substr($email['Flagged'], 1);\r\n            }\r\n          }\r\n        }\r\n\r\n\r\n        $ar = [\r\n          $cfg['id_user'] => $this->user->getId(),\r\n          $cfg['id_folder'] => $folder['id'],\r\n          $cfg['msg_uid'] => $email['uid'],\r\n          $cfg['msg_unique_id'] => $email['message_id'],\r\n          $cfg['date'] => date('Y-m-d H:i:s', strtotime($email['date'])),\r\n          $cfg['id_sender'] => $id_sender,\r\n          $cfg['subject'] => $email['subject'] ?: '',\r\n          $cfg['size'] => $email['Size'],\r\n          $cfg['attachments'] => empty($email['attachments']) ? null : json_encode($email['attachments']),\r\n          $cfg['flags'] => $email['Flagged'] ?: null,\r\n          $cfg['is_read'] => $email['Unseen'] ? 0 : 1,\r\n          $cfg['id_parent'] => $id_parent,\r\n          $cfg['id_thread'] => $id_thread,\r\n          $cfg['external_uids'] => $external ? json_encode($external) : null,\r\n          $cfg['excerpt'] => \"\"\r\n        ];\r\n\r\n        X::log([\r\n          \"Insert email\",\r\n          $ar\r\n        ], 'poller_email_error');\r\n\r\n        if ($existing) {\r\n          $id = $existing;\r\n        } else if ($this->db->insert($table, $ar)) {\r\n          $id = $this->db->lastId();\r\n          $mb = $this->getMailbox($folder['id_account']);\r\n          $mb->selectFolder($folder['uid']);\r\n\r\n          $number = $mb->getMsgNo($email['uid']);\r\n          if ($number) {\r\n            $msg = $mb->getMsg($number, $id, $folder['id_account']);\r\n            if (empty($text)) {\r\n              $text = $msg['plain'];\r\n            }\r\n          } else {\r\n            $text = \"\";\r\n          }\r\n\r\n          if (is_null($text)) {\r\n            $text = \"\";\r\n          }\r\n          \/\/ update excerpt column where id is same\r\n          $this->db->update($table, [$cfg['excerpt'] => $text], [$cfg['id'] => $id]);\r\n          foreach (Mailbox::getDestFields() as $df) {\r\n            if (in_array($df, ['to', 'cc', 'bcc']) && !empty($email[$df])) {\r\n              foreach ($email[$df] as $dest) {\r\n                if (!empty($dest['id'])) {\r\n                  $this->addLinkToMail($id, $dest['id'], $df);\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n\r\n      }\r\n    }\r\n\r\n    return $id;\r\n  }",
            "startLine": 985,
            "endLine": 1130,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 2,
            "returns": [],
            "parent": false,
            "arguments": [
                {
                    "name": "folder",
                    "position": 0,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "email",
                    "position": 1,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "addContactFromMail": {
            "name": "addContactFromMail",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(array $dest, bool $blacklist = false)\n  {\n    if (X::hasProp($dest, 'email', true)) {\r\n      if (!Str::isEmail($dest['email'])) {\r\n        return null;\r\n      }\r\n\r\n      $cfg_contacts = $this->class_cfg['arch']['users_contacts'];\r\n      $cfg_links = $this->class_cfg['arch']['users_contacts_links'];\r\n      $table_contacts = $this->class_cfg['tables']['users_contacts'];\r\n      $table_links = $this->class_cfg['tables']['users_contacts_links'];\r\n      if ($this->db->insert($table_contacts, [\r\n        $cfg_contacts['id_user'] => $this->user->getId(),\r\n        $cfg_contacts['name'] => empty($dest['name']) ? null : mb_substr($dest['name'], 0, 100),\r\n        $cfg_contacts['blacklist'] => $blacklist ? 1 : 0\r\n      ])) {\r\n        $id_contact = $this->db->lastId();\r\n        if ($this->db->insert($table_links, [\r\n          'id_contact' => $id_contact,\r\n          'type' => 'email',\r\n          'value' => $dest['email']\r\n        ])) {\r\n          return $this->db->lastId();\r\n        }\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }",
            "startLine": 1133,
            "endLine": 1161,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 1,
            "returns": [
                null,
                "string"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "dest",
                    "position": 0,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "blacklist",
                    "position": 1,
                    "type": "bool",
                    "required": false,
                    "has_default": true,
                    "default": false,
                    "default_name": ""
                }
            ]
        },
        "getLink": {
            "name": "getLink",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id)\n  {\n    $cfg = $this->class_cfg['arch']['users_contacts_links'];\r\n    $table = $this->class_cfg['tables']['users_contacts_links'];\r\n    $data = $this->db->rselect($table, $cfg, [$cfg['id'] => $id]);\r\n    return $data ?: null;\r\n  }",
            "startLine": 1164,
            "endLine": 1170,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [
                null,
                "array"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "addLinkToMail": {
            "name": "addLinkToMail",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(string $id_email, string $id_link, string $type)\n  {\n    $cfg = $this->class_cfg['arch']['users_emails_recipients'];\r\n    $table = $this->class_cfg['tables']['users_emails_recipients'];\r\n    return (bool)$this->db->insertIgnore(\r\n      $table,\r\n      [\r\n        $cfg['id_email'] => $id_email,\r\n        $cfg['id_contact_link'] => $id_link,\r\n        $cfg['type'] => $type\r\n      ]\r\n    );\r\n\r\n  }",
            "startLine": 1173,
            "endLine": 1186,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 3,
            "numberOfRequiredParameters": 3,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id_email",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "id_link",
                    "position": 1,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "type",
                    "position": 2,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "addSentToLink": {
            "name": "addSentToLink",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(string $id_link, string $date = NULL)\n  {\n    if ($link = $this->getLink($id_link)) {\r\n      $cfg = $this->class_cfg['arch']['users_contacts_links'];\r\n      $table = $this->class_cfg['tables']['users_contacts_links'];\r\n      if (!$date) {\r\n        $date = date('Y-m-d H:i:s');\r\n      }\r\n      if ($link['last_sent'] && ($link['last_sent'] > $date)) {\r\n        $date = $link['last_sent'];\r\n      }\r\n\r\n      return (bool)$this->db->update(\r\n        $table,\r\n        [\r\n          $cfg['num_sent'] => $link[$cfg['num_sent']] + 1,\r\n          $cfg['last_sent'] => $date\r\n        ], [\r\n          'id' => $id_link\r\n        ]\r\n      );\r\n    }\r\n\r\n    return false;\r\n  }",
            "startLine": 1189,
            "endLine": 1213,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 1,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id_link",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "date",
                    "position": 1,
                    "type": "string",
                    "required": false,
                    "has_default": true,
                    "default": null,
                    "default_name": ""
                }
            ]
        },
        "retrieveEmail": {
            "name": "retrieveEmail",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(string $email)\n  {\n    if (Str::isEmail($email)) {\r\n      $contacts = $this->class_cfg['tables']['users_contacts'];\r\n      $cfg_c = $this->class_cfg['arch']['users_contacts'];\r\n      $links = $this->class_cfg['tables']['users_contacts_links'];\r\n      $cfg_l = $this->class_cfg['arch']['users_contacts_links'];\r\n      return $this->db->selectOne(\r\n        [\r\n          'tables' => [$links],\r\n          'field' => $this->db->cfn($cfg_l['id'], $links),\r\n          'join' => [\r\n            [\r\n              'table' => $contacts,\r\n              'on' => [\r\n                [\r\n                  'field' => $cfg_l['id_contact'],\r\n                  'exp' => $this->db->cfn($cfg_c['id'], $contacts)\r\n                ]\r\n              ]\r\n\r\n            ]\r\n          ],\r\n          'where' => [\r\n            'value' => $email,\r\n            'id_user' => $this->user->getId(),\r\n            'type' => 'email'\r\n          ]\r\n        ]\r\n      );\r\n    }\r\n\r\n    return null;\r\n  }",
            "startLine": 1216,
            "endLine": 1249,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [
                null,
                "string"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "email",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "getContact": {
            "name": "getContact",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(string $email, string $name, $force)\n  {\n\r\n  }",
            "startLine": 1252,
            "endLine": 1255,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 3,
            "numberOfRequiredParameters": 3,
            "returns": [],
            "parent": false,
            "arguments": [
                {
                    "name": "email",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "name",
                    "position": 1,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "force",
                    "position": 2,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "getContacts": {
            "name": "getContacts",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    $contacts = $this->class_cfg['tables']['users_contacts'];\r\n    $cfg_c = $this->class_cfg['arch']['users_contacts'];\r\n    $links = $this->class_cfg['tables']['users_contacts_links'];\r\n    $cfg_l = $this->class_cfg['arch']['users_contacts_links'];\r\n    $rows = $this->db->rselectAll(\r\n      [\r\n        'tables' => [$links],\r\n        'fields' => [\r\n          $this->db->cfn($cfg_l['id'], $links),\r\n          $this->db->cfn($cfg_l['value'], $links),\r\n          $this->db->cfn($cfg_l['id_contact'], $links),\r\n          $this->db->cfn($cfg_l['num_sent'], $links),\r\n          $this->db->cfn($cfg_l['last_sent'], $links),\r\n          $this->db->cfn($cfg_c['name'], $contacts),\r\n          $this->db->cfn($cfg_c['cfg'], $contacts),\r\n          $this->db->cfn($cfg_c['blacklist'], $contacts),\r\n          'sortIndex' => 'IFNULL(' . $this->db->cfn($cfg_c['name'], $contacts, true) . ',' . $this->db->cfn($cfg_l['value'], $links) . ')'\r\n        ],\r\n        'join' => [\r\n          [\r\n            'table' => $contacts,\r\n            'on' => [\r\n              [\r\n                'field' => $cfg_l['id_contact'],\r\n                'exp' => $this->db->cfn($cfg_c['id'], $contacts)\r\n              ]\r\n            ]\r\n\r\n          ]\r\n        ],\r\n        'where' => [\r\n          'id_user' => $this->user->getId(),\r\n          'type' => 'email'\r\n        ],\r\n        'order' => [\r\n          'sortIndex' => 'ASC'\r\n        ]\r\n      ]\r\n    );\r\n    $res = [];\r\n    if ($rows) {\r\n      foreach ($rows as $r) {\r\n        $res[] = [\r\n          'value' => $r['id'],\r\n          'text' => (empty($r['name']) ? '' : $r['name'] . ' - ') . $r['value'],\r\n          'cfg' => empty($r['cfg']) ? [] : json_decode($r['cfg'], true),\r\n          'id_contact' => $r['id_contact'],\r\n          'num_sent' => $r['num_sent'],\r\n          'last_sent' => $r['last_sent'],\r\n          'blacklist' => $r['blacklist']\r\n        ];\r\n      }\r\n    }\r\n\r\n    return $res;\r\n  }",
            "startLine": 1258,
            "endLine": 1315,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                "array"
            ],
            "parent": false,
            "arguments": []
        },
        "syncFolders": {
            "name": "syncFolders",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(string $id_account, array $subscribed = [])\n  {\n    \/\/ get Mailbox account\r\n    if ($mb = $this->getMailbox($id_account)) {\r\n      \/\/ get the parameter (host and port)\r\n      $mbParam = $mb->getParams();\r\n      \/\/ get the option 'folders'\r\n      $types = self::getFolderTypes();\r\n\r\n      $put_in_res = function (array $a, &$res, $prefix = '') use (&$put_in_res, $subscribed) {\r\n        \/\/ set the first value of $a in $ele and remove it in the array\r\n        $ele = array_shift($a);\r\n        \/\/ search if res contain an array with 'text' => $ele and return the index or null instead\r\n        $idx = X::find($res, ['text' => $ele]);\r\n\r\n        if (null === $idx) {\r\n          \/\/ count number of element in array (useless ?)\r\n          $idx = count($res);\r\n          \/\/ add $ele in the res array\r\n          $res[] = [\r\n            'text' => $ele,\r\n            'uid' => $prefix . $ele,\r\n            'items' => [],\r\n            'subscribed' => in_array($prefix . $ele, $subscribed)\r\n          ];\r\n        }\r\n        if (count($a)) {\r\n          $put_in_res($a, $res[$idx]['items'], $prefix . $ele . '.');\r\n        }\r\n      };\r\n\r\n      $compare = function (\r\n        array $real,\r\n        array $db,\r\n        array &$res = null,\r\n              $id_parent = null\r\n      ) use (&$compare): array {\r\n        if (!$res) {\r\n          $res = ['add' => [], 'delete' => []];\r\n        }\r\n\r\n        foreach ($real as $r) {\r\n          $idx = X::find($db, ['text' => $r['text']]);\r\n          if (null === $idx) {\r\n            if ($id_parent) {\r\n              $r['id_parent'] = $id_parent;\r\n            }\r\n\r\n            $res['add'][] = $r;\r\n          } elseif ($r['items'] && $db[$idx]['items']) {\r\n            $compare($r['items'], $db[$idx]['items'], $res, $db[$idx]['id']);\r\n          }\r\n        }\r\n\r\n        foreach ($db as $r) {\r\n          $idx = X::find($real, ['text' => $r['text']]);\r\n          if (null === $idx) {\r\n            $res['delete'][] = $r;\r\n          }\r\n        }\r\n\r\n        return $res;\r\n      };\r\n\r\n      $pref = $this->pref;\r\n\r\n      $import = function (array $to_add, $id_parent = null) use ($id_account, &$pref, &$import, &$types) {\r\n        foreach ($to_add as $a) {\r\n          if ($id_parent) {\r\n            $a['id_parent'] = $id_parent;\r\n            $a['id_option'] = X::getField($types, ['code' => 'folders'], 'id');\r\n          } else {\r\n            foreach ($types as $type) {\r\n              if (!empty($type['names'])) {\r\n                if (in_array($a['text'], $type['names'], true)) {\r\n                  $a['id_option'] = $type['id'];\r\n                  break;\r\n                }\r\n              }\r\n            }\r\n\r\n            if (!isset($a['id_option'])) {\r\n              $a['id_option'] = X::getField($types, ['code' => 'folders'], 'id');\r\n            }\r\n          }\r\n\r\n          if ($id_bit = $pref->addBit($id_account, $a)) {\r\n            if (!empty($a['items'])) {\r\n              $import($a['items'], $id_bit);\r\n            }\r\n          }\r\n        }\r\n      };\r\n\r\n      $res = [];\r\n      $all = $mb->listAllFolders();\r\n      foreach ($all as $dir) {\r\n        $tmp = str_replace($mbParam, '', $dir);\r\n        $bits = X::split($tmp, '.');\r\n        $put_in_res($bits, $res);\r\n      }\r\n\r\n      \/\/ We have a tree\r\n      $db_tree = $this->pref->getFullBits($id_account);\r\n\r\n      $result = $compare($res, $db_tree);\r\n\r\n      $import($result['add']);\r\n      return ['real' => $res, 'db' => $db_tree, 'compare' => $result];\r\n    }\r\n\r\n    return null;\r\n  }",
            "startLine": 1318,
            "endLine": 1430,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 1,
            "returns": [],
            "parent": false,
            "arguments": [
                {
                    "name": "id_account",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "subscribed",
                    "position": 1,
                    "type": "array",
                    "required": false,
                    "has_default": true,
                    "default": [],
                    "default_name": ""
                }
            ]
        },
        "send": {
            "name": "send",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(string $id_account, array $cfg)\n  {\n    if ($mb = $this->getMailbox($id_account)) {\r\n      $fields = ['to', 'cc', 'bcc'];\r\n      $num = 0;\r\n      $dest = [];\r\n      \/*\r\n                foreach ($fields as $field) {\r\n                  $dest[$field] = [];\r\n                  if (!empty($cfg[$field])) {\r\n                    foreach ($cfg[$field] as $d) {\r\n                      if (Str::isEmail($d)) {\r\n                        $dest[$field][] = $d;\r\n                        $num++;\r\n                      }\r\n                    }\r\n                  }\r\n                }\r\n                *\/\r\n\r\n      if (!empty($cfg['title']) || !empty($cfg['text'])) {\r\n        $mailer = $mb->getMailer();\r\n        return $mailer->send($cfg);\r\n      }\r\n    }\r\n\r\n    throw new \\Exception(X::_(\"Impossible to find the mailbox\"));\r\n  }",
            "startLine": 1433,
            "endLine": 1460,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 2,
            "returns": [
                "int"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id_account",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "cfg",
                    "position": 1,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "getStructure": {
            "name": "getStructure",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_account, $force)\n  {\n\r\n  }",
            "startLine": 1463,
            "endLine": 1466,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 2,
            "returns": [],
            "parent": false,
            "arguments": [
                {
                    "name": "id_account",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "force",
                    "position": 1,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "test": {
            "name": "test",
            "summary": "Checks whether the error property has been set (so an error happened).",
            "description": "",
            "description_parts": [],
            "file": "bbn\\Models\\Cls\\Basic",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    if ($this->error) {\n      return false;\n    }\n\n    return true;\n  }",
            "startLine": 50,
            "endLine": 57,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [],
            "parent": {
                "name": "test",
                "summary": "Checks whether the error property has been set (so an error happened).",
                "description": "",
                "description_parts": [],
                "file": "bbn\\Models\\Cls\\Basic",
                "static": false,
                "visibility": "public",
                "final": false,
                "code": "function()\n  {\n    if ($this->error) {\n      return false;\n    }\n\n    return true;\n  }",
                "startLine": 50,
                "endLine": 57,
                "isDeprecated": false,
                "isGenerator": false,
                "isInternal": false,
                "isUserDefined": true,
                "isVariadic": false,
                "returnsReference": false,
                "numberOfParameters": 0,
                "numberOfRequiredParameters": 0,
                "returns": [],
                "parent": false,
                "arguments": []
            },
            "arguments": []
        },
        "check": {
            "name": "check",
            "summary": "Checks whether the error property has been set (so an error happened).",
            "description": "",
            "description_parts": [],
            "file": "bbn\\Models\\Cls\\Basic",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    if ($this->error) {\n      return false;\n    }\n\n    return true;\n  }",
            "startLine": 64,
            "endLine": 71,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [],
            "parent": {
                "name": "check",
                "summary": "Checks whether the error property has been set (so an error happened).",
                "description": "",
                "description_parts": [],
                "file": "bbn\\Models\\Cls\\Basic",
                "static": false,
                "visibility": "public",
                "final": false,
                "code": "function()\n  {\n    if ($this->error) {\n      return false;\n    }\n\n    return true;\n  }",
                "startLine": 64,
                "endLine": 71,
                "isDeprecated": false,
                "isGenerator": false,
                "isInternal": false,
                "isUserDefined": true,
                "isVariadic": false,
                "returnsReference": false,
                "numberOfParameters": 0,
                "numberOfRequiredParameters": 0,
                "returns": [],
                "parent": false,
                "arguments": []
            },
            "arguments": []
        },
        "getError": {
            "name": "getError",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\Models\\Cls\\Basic",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return $this->error;\n  }",
            "startLine": 85,
            "endLine": 88,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [],
            "parent": {
                "name": "getError",
                "summary": "",
                "description": "",
                "description_parts": [],
                "file": "bbn\\Models\\Cls\\Basic",
                "static": false,
                "visibility": "public",
                "final": false,
                "code": "function()\n  {\n    return $this->error;\n  }",
                "startLine": 85,
                "endLine": 88,
                "isDeprecated": false,
                "isGenerator": false,
                "isInternal": false,
                "isUserDefined": true,
                "isVariadic": false,
                "returnsReference": false,
                "numberOfParameters": 0,
                "numberOfRequiredParameters": 0,
                "returns": [],
                "parent": false,
                "arguments": []
            },
            "arguments": []
        },
        "getErrors": {
            "name": "getErrors",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\Models\\Cls\\Basic",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n\n  }",
            "startLine": 91,
            "endLine": 94,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [],
            "parent": {
                "name": "getErrors",
                "summary": "",
                "description": "",
                "description_parts": [],
                "file": "bbn\\Models\\Cls\\Basic",
                "static": false,
                "visibility": "public",
                "final": false,
                "code": "function()\n  {\n\n  }",
                "startLine": 91,
                "endLine": 94,
                "isDeprecated": false,
                "isGenerator": false,
                "isInternal": false,
                "isUserDefined": true,
                "isVariadic": false,
                "returnsReference": false,
                "numberOfParameters": 0,
                "numberOfRequiredParameters": 0,
                "returns": [],
                "parent": false,
                "arguments": []
            },
            "arguments": []
        },
        "log": {
            "name": "log",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\Models\\Cls\\Basic",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    if ($this->isDebug()) {\n        $ar = \\func_get_args();\n        $cn = bbn\\Str::encodeFilename(str_replace('\\\\', '_', \\get_class($this)));\n      foreach ($ar as $a){\n            X::log($a, $cn);\n      }\n    }\n  }",
            "startLine": 97,
            "endLine": 106,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [],
            "parent": {
                "name": "log",
                "summary": "",
                "description": "",
                "description_parts": [],
                "file": "bbn\\Models\\Cls\\Basic",
                "static": false,
                "visibility": "public",
                "final": false,
                "code": "function()\n  {\n    if ($this->isDebug()) {\n        $ar = \\func_get_args();\n        $cn = bbn\\Str::encodeFilename(str_replace('\\\\', '_', \\get_class($this)));\n      foreach ($ar as $a){\n            X::log($a, $cn);\n      }\n    }\n  }",
                "startLine": 97,
                "endLine": 106,
                "isDeprecated": false,
                "isGenerator": false,
                "isInternal": false,
                "isUserDefined": true,
                "isVariadic": false,
                "returnsReference": false,
                "numberOfParameters": 0,
                "numberOfRequiredParameters": 0,
                "returns": [],
                "parent": false,
                "arguments": []
            },
            "arguments": []
        },
        "__call": {
            "name": "__call",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\Models\\Cls\\Basic",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($name, $arguments)\n  {\n    $class = \\get_class($this);\n    throw new \\Exception(\n      sprintf(\n        X::_(\"Wrong method used for the class %s: %s with the following arguments:\"),\n        $class,\n        $name,\n        implode(', ', $arguments)\n      )\n    );\n  }",
            "startLine": 114,
            "endLine": 125,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 2,
            "returns": [],
            "parent": {
                "name": "__call",
                "summary": "",
                "description": "",
                "description_parts": [],
                "file": "bbn\\Models\\Cls\\Basic",
                "static": false,
                "visibility": "public",
                "final": false,
                "code": "function($name, $arguments)\n  {\n    $class = \\get_class($this);\n    throw new \\Exception(\n      sprintf(\n        X::_(\"Wrong method used for the class %s: %s with the following arguments:\"),\n        $class,\n        $name,\n        implode(', ', $arguments)\n      )\n    );\n  }",
                "startLine": 114,
                "endLine": 125,
                "isDeprecated": false,
                "isGenerator": false,
                "isInternal": false,
                "isUserDefined": true,
                "isVariadic": false,
                "returnsReference": false,
                "numberOfParameters": 2,
                "numberOfRequiredParameters": 2,
                "returns": [],
                "parent": false,
                "arguments": [
                    {
                        "name": "name",
                        "position": 0,
                        "type": "",
                        "required": true,
                        "has_default": false,
                        "default": "",
                        "default_name": ""
                    },
                    {
                        "name": "arguments",
                        "position": 1,
                        "type": "",
                        "required": true,
                        "has_default": false,
                        "default": "",
                        "default_name": ""
                    }
                ]
            },
            "arguments": [
                {
                    "name": "name",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "arguments",
                    "position": 1,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "isDebug": {
            "name": "isDebug",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\Models\\Cls\\Basic",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return $this->debug || (defined(\"BBN_IS_DEV\") && BBN_IS_DEV);\n  }",
            "startLine": 131,
            "endLine": 134,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [],
            "parent": {
                "name": "isDebug",
                "summary": "",
                "description": "",
                "description_parts": [],
                "file": "bbn\\Models\\Cls\\Basic",
                "static": false,
                "visibility": "public",
                "final": false,
                "code": "function()\n  {\n    return $this->debug || (defined(\"BBN_IS_DEV\") && BBN_IS_DEV);\n  }",
                "startLine": 131,
                "endLine": 134,
                "isDeprecated": false,
                "isGenerator": false,
                "isInternal": false,
                "isUserDefined": true,
                "isVariadic": false,
                "returnsReference": false,
                "numberOfParameters": 0,
                "numberOfRequiredParameters": 0,
                "returns": [],
                "parent": false,
                "arguments": []
            },
            "arguments": []
        },
        "setDebug": {
            "name": "setDebug",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\Models\\Cls\\Basic",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(bool $debug)\n  {\n    $this->debug = $debug;\n  }",
            "startLine": 141,
            "endLine": 144,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [],
            "parent": {
                "name": "setDebug",
                "summary": "",
                "description": "",
                "description_parts": [],
                "file": "bbn\\Models\\Cls\\Basic",
                "static": false,
                "visibility": "public",
                "final": false,
                "code": "function(bool $debug)\n  {\n    $this->debug = $debug;\n  }",
                "startLine": 141,
                "endLine": 144,
                "isDeprecated": false,
                "isGenerator": false,
                "isInternal": false,
                "isUserDefined": true,
                "isVariadic": false,
                "returnsReference": false,
                "numberOfParameters": 1,
                "numberOfRequiredParameters": 1,
                "returns": [],
                "parent": false,
                "arguments": [
                    {
                        "name": "debug",
                        "position": 0,
                        "type": "bool",
                        "required": true,
                        "has_default": false,
                        "default": "",
                        "default_name": ""
                    }
                ]
            },
            "arguments": [
                {
                    "name": "debug",
                    "position": 0,
                    "type": "bool",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "exists": {
            "name": "exists",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($filter)\n  {\n    if (!$this->class_table_index) {\n      throw new Exception(X::_(\"The table index parameter should be defined\"));\n    }\n\n    $f = $this->class_cfg['arch'][$this->class_table_index];\n    if (is_string($filter)) {\n      $cfg = [$f['id'] => $filter];\n    }\n    elseif (is_array($filter)) {\n      $cfg = $filter;\n    }\n\n    if (!empty($cfg) && $arr = $this->db->count(\n      $this->class_table,\n      $cfg\n    )) {\n      return true;\n    }\n\n    return false;\n  }",
            "startLine": 37,
            "endLine": 59,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "filter",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "getClassCfg": {
            "name": "getClassCfg",
            "summary": "Returns the class configuration.",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return $this->class_cfg;\n  }",
            "startLine": 67,
            "endLine": 70,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [],
            "parent": false,
            "arguments": []
        },
        "getFields": {
            "name": "getFields",
            "summary": "Returns the fields of the main table.",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return $this->fields;\n  }",
            "startLine": 78,
            "endLine": 81,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [],
            "parent": false,
            "arguments": []
        },
        "insert": {
            "name": "insert",
            "summary": "Inserts a new row in the table.",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(array $data)\n  {\n    if ($data = $this->prepare($data)) {\n      $ccfg = $this->getClassCfg();\n      if ($this->db->insert($ccfg['table'], $data)) {\n        return $this->db->lastId();\n      }\n    }\n\n    return null;\n  }",
            "startLine": 91,
            "endLine": 101,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [
                null,
                "string"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "data",
                    "position": 0,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "delete": {
            "name": "delete",
            "summary": "Deletes a single row from the table through its id.",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(string $id)\n  {\n    if ($data = $this->exists($id)) {\n      $ccfg = $this->getClassCfg();\n      $f = $ccfg['arch'][$this->class_table_index];\n      return (bool)$this->db->delete($ccfg['table'], [$f['id'] => $id]);\n    }\n\n    return false;\n  }",
            "startLine": 111,
            "endLine": 120,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "update": {
            "name": "update",
            "summary": "Updates a single row in the table through its id.",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(string $id, array $data, bool $addCfg = false)\n  {\n    if (!$this->exists($id)) {\n      throw new Exception(X::_(\"Impossible to find the given row\"));\n    }\n\n    if ($addCfg) {\n      $data = array_merge($this->rselect($id), $data);\n    }\n\n    if ($data = $this->prepare($data)) {\n      $ccfg = $this->getClassCfg();\n      $f = $ccfg['arch'][$this->class_table_index];\n      return (bool)$this->db->update($ccfg['table'], $data, [$f['id'] => $id]);\n    }\n\n    return false;\n  }",
            "startLine": 131,
            "endLine": 148,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 3,
            "numberOfRequiredParameters": 2,
            "returns": [
                "bool"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "data",
                    "position": 1,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "addCfg",
                    "position": 2,
                    "type": "bool",
                    "required": false,
                    "has_default": true,
                    "default": false,
                    "default_name": ""
                }
            ]
        },
        "selectOne": {
            "name": "selectOne",
            "summary": "Retrieves a row as an object from the table through its id.",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(string $field, $filter, array $order = [])\n  {\n    if ($res = $this->dbConfigSingleSelection($filter, $order, false, [$field])) {\n      return $res[$field] ?? null;\n    }\n\n    return null;\n  }",
            "startLine": 159,
            "endLine": 166,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 3,
            "numberOfRequiredParameters": 2,
            "returns": [],
            "parent": false,
            "arguments": [
                {
                    "name": "field",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "filter",
                    "position": 1,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "order",
                    "position": 2,
                    "type": "array",
                    "required": false,
                    "has_default": true,
                    "default": [],
                    "default_name": ""
                }
            ]
        },
        "select": {
            "name": "select",
            "summary": "Retrieves a row as an object from the table through its id.",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($filter, array $order = [])\n  {\n    return $this->dbConfigSingleSelection($filter, $order, true);\n  }",
            "startLine": 177,
            "endLine": 180,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 1,
            "returns": [
                null,
                "stdClass"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "filter",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "order",
                    "position": 1,
                    "type": "array",
                    "required": false,
                    "has_default": true,
                    "default": [],
                    "default_name": ""
                }
            ]
        },
        "rselect": {
            "name": "rselect",
            "summary": "Retrieves a row as an array from the table through its id.",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($filter, array $order = [])\n  {\n    return $this->dbConfigSingleSelection($filter, $order, false);\n  }",
            "startLine": 191,
            "endLine": 194,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 1,
            "returns": [
                null,
                "array"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "filter",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "order",
                    "position": 1,
                    "type": "array",
                    "required": false,
                    "has_default": true,
                    "default": [],
                    "default_name": ""
                }
            ]
        },
        "count": {
            "name": "count",
            "summary": "Returns the number of rows from the table for the given conditions.",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(array $filter = [])\n  {\n    if (!$this->class_table_index) {\n      throw new Exception(X::_(\"The table index parameter should be defined\"));\n    }\n\n    return $this->db->count($this->class_table, $filter);\n  }",
            "startLine": 204,
            "endLine": 211,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 0,
            "returns": [
                "int"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "filter",
                    "position": 0,
                    "type": "array",
                    "required": false,
                    "has_default": true,
                    "default": [],
                    "default_name": ""
                }
            ]
        },
        "selectAll": {
            "name": "selectAll",
            "summary": "Returns an array of rows as objects from the table for the given conditions.",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(array $filter, array $order = [], int $limit = 0, int $start = 0)\n  {\n    return $this->dbConfigSelection($filter, $order, $limit, $start, true);\n  }",
            "startLine": 224,
            "endLine": 227,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 4,
            "numberOfRequiredParameters": 1,
            "returns": [
                "array"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "filter",
                    "position": 0,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "order",
                    "position": 1,
                    "type": "array",
                    "required": false,
                    "has_default": true,
                    "default": [],
                    "default_name": ""
                },
                {
                    "name": "limit",
                    "position": 2,
                    "type": "int",
                    "required": false,
                    "has_default": true,
                    "default": 0,
                    "default_name": ""
                },
                {
                    "name": "start",
                    "position": 3,
                    "type": "int",
                    "required": false,
                    "has_default": true,
                    "default": 0,
                    "default_name": ""
                }
            ]
        },
        "rselectAll": {
            "name": "rselectAll",
            "summary": "Returns an array of rows as arrays from the table for the given conditions.",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(array $filter, array $order = [], int $limit = 0, int $start = 0)\n  {\n    return $this->dbConfigSelection($filter, $order, $limit, $start, false);\n  }",
            "startLine": 240,
            "endLine": 243,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 4,
            "numberOfRequiredParameters": 1,
            "returns": [
                "array"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "filter",
                    "position": 0,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "order",
                    "position": 1,
                    "type": "array",
                    "required": false,
                    "has_default": true,
                    "default": [],
                    "default_name": ""
                },
                {
                    "name": "limit",
                    "position": 2,
                    "type": "int",
                    "required": false,
                    "has_default": true,
                    "default": 0,
                    "default_name": ""
                },
                {
                    "name": "start",
                    "position": 3,
                    "type": "int",
                    "required": false,
                    "has_default": true,
                    "default": 0,
                    "default_name": ""
                }
            ]
        },
        "getOptionRoot": {
            "name": "getOptionRoot",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    self::optionalInit();\n    return self::$option_root_id;\n  }",
            "startLine": 150,
            "endLine": 154,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [],
            "parent": false,
            "arguments": []
        },
        "getAppuiRoot": {
            "name": "getAppuiRoot",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    self::optionalInit();\n    return self::$option_appui_id;\n  }",
            "startLine": 157,
            "endLine": 161,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [],
            "parent": false,
            "arguments": []
        },
        "getOptionsObject": {
            "name": "getOptionsObject",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    $o = Option::getInstance();\n    if (!$o) {\n      throw new Exception(X::_(\"Impossible to get the options object from class\").' '.__CLASS__);\n    }\n\n    return $o;\n  }",
            "startLine": 164,
            "endLine": 172,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                "bbn\\Appui\\Option"
            ],
            "parent": false,
            "arguments": []
        },
        "getOptionId": {
            "name": "getOptionId",
            "summary": "Returns The option's ID of a category, i.e. direct children of option's root",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return self::getOptionsObject()->fromCode(...self::_treat_args(func_get_args()));\n  }",
            "startLine": 181,
            "endLine": 184,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [],
            "parent": false,
            "arguments": []
        },
        "getOptionsIds": {
            "name": "getOptionsIds",
            "summary": "Undocumented function",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return array_flip(\n      array_filter(\n        self::getOptionsObject()->getCodes(...self::_treat_args(func_get_args())),\n        function ($a) {\n          return $a !== null;\n        }\n      )\n    );\n  }",
            "startLine": 193,
            "endLine": 203,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                "array"
            ],
            "parent": false,
            "arguments": []
        },
        "getOptionsTree": {
            "name": "getOptionsTree",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return ($tree = self::getOptionsObject()->fullTree(...self::_treat_args(func_get_args()))) ? $tree['items'] : [];\n  }",
            "startLine": 206,
            "endLine": 209,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [],
            "parent": false,
            "arguments": []
        },
        "getOptionsTreeRef": {
            "name": "getOptionsTreeRef",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return ($tree = self::getOptionsObject()->fullTreeRef(...self::_treat_args(func_get_args()))) ? $tree['items'] : [];\n  }",
            "startLine": 212,
            "endLine": 215,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [],
            "parent": false,
            "arguments": []
        },
        "getOptions": {
            "name": "getOptions",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return self::getOptionsObject()->fullOptions(...self::_treat_args(func_get_args()));\n  }",
            "startLine": 218,
            "endLine": 221,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [],
            "parent": false,
            "arguments": []
        },
        "getOptionsRef": {
            "name": "getOptionsRef",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return self::getOptionsObject()->fullOptionsRef(...self::_treat_args(func_get_args()));\n  }",
            "startLine": 224,
            "endLine": 227,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [],
            "parent": false,
            "arguments": []
        },
        "getOption": {
            "name": "getOption",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return self::getOptionsObject()->option(...self::_treat_args(func_get_args()));\n  }",
            "startLine": 230,
            "endLine": 233,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [],
            "parent": false,
            "arguments": []
        },
        "getOptionsTextValue": {
            "name": "getOptionsTextValue",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return ($id = self::getOptionId(...func_get_args())) ? self::getOptionsObject()->textValueOptions($id) : [];\n  }",
            "startLine": 236,
            "endLine": 239,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [],
            "parent": false,
            "arguments": []
        },
        "getOptionsTextValueRef": {
            "name": "getOptionsTextValueRef",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return ($id = self::getOptionId(...func_get_args())) ? self::getOptionsObject()->textValueOptionsRef($id) : [];\n  }",
            "startLine": 242,
            "endLine": 245,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [],
            "parent": false,
            "arguments": []
        },
        "getOptionId": {
            "name": "getOptionId",
            "summary": "Returns The option's ID of a category, i.e. direct children of option's root",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return self::getOptionsObject()->fromCode(...self::_treat_args(func_get_args(), true));\n  }",
            "startLine": 254,
            "endLine": 257,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                null,
                "string"
            ],
            "parent": false,
            "arguments": []
        },
        "getOptionsIds": {
            "name": "getOptionsIds",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return array_flip(\n      array_filter(\n        self::getOptionsObject()->getCodes(\n          ...self::_treat_args(func_get_args(), true)\n        ),\n        function ($a) {\n          return $a !== null;\n        }\n      )\n    );\n  }",
            "startLine": 260,
            "endLine": 272,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                "array"
            ],
            "parent": false,
            "arguments": []
        },
        "getOptionsTree": {
            "name": "getOptionsTree",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return ($tree = self::getOptionsObject()->fullTree(...self::_treat_args(func_get_args(), true)) ) ? $tree['items'] : [];\n  }",
            "startLine": 275,
            "endLine": 278,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                "array"
            ],
            "parent": false,
            "arguments": []
        },
        "getOptions": {
            "name": "getOptions",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return self::getOptionsObject()->fullOptions(...self::_treat_args(func_get_args(), true));\n  }",
            "startLine": 281,
            "endLine": 284,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                null,
                "array"
            ],
            "parent": false,
            "arguments": []
        },
        "getOption": {
            "name": "getOption",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return self::getOptionsObject()->option(...self::_treat_args(func_get_args(), true));\n  }",
            "startLine": 287,
            "endLine": 290,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                null,
                "array"
            ],
            "parent": false,
            "arguments": []
        },
        "getOptionsTextValue": {
            "name": "getOptionsTextValue",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\User\\Email",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return ($id = self::getOptionId(...func_get_args())) ? self::getOptionsObject()->textValueOptions($id) : [];\n  }",
            "startLine": 293,
            "endLine": 296,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [],
            "parent": false,
            "arguments": []
        }
    },
    "properties": null,
    "staticProperties": {
        "default_class_cfg": {
            "table": "bbn_users_emails",
            "tables": {
                "users_emails": "bbn_users_emails",
                "users_emails_aliases": "bbn_users_emails_aliases",
                "users_emails_recipients": "bbn_users_emails_recipients",
                "users_contacts": "bbn_users_contacts",
                "users_contacts_links": "bbn_users_contacts_links"
            },
            "arch": {
                "users_emails": {
                    "id": "id",
                    "id_user": "id_user",
                    "id_folder": "id_folder",
                    "msg_uid": "msg_uid",
                    "msg_unique_id": "msg_unique_id",
                    "date": "date",
                    "id_sender": "id_sender",
                    "subject": "subject",
                    "excerpt": "excerpt",
                    "size": "size",
                    "attachments": "attachments",
                    "flags": "flags",
                    "is_read": "is_read",
                    "id_parent": "id_parent",
                    "id_thread": "id_thread",
                    "external_uids": "external_uids"
                },
                "users_emails_aliases": {
                    "id_account": "id_account",
                    "id_link": "id_link",
                    "main": "main"
                },
                "users_emails_recipients": {
                    "id_email": "id_email",
                    "id_contact_link": "id_contact_link",
                    "type": "type"
                },
                "users_contacts": {
                    "id": "id",
                    "id_user": "id_user",
                    "name": "name",
                    "blacklist": "blacklist",
                    "cfg": "cfg"
                },
                "users_contacts_links": {
                    "id": "id",
                    "id_contact": "id_contact",
                    "type": "type",
                    "value": "value",
                    "num_sent": "num_sent",
                    "last_sent": "last_sent"
                }
            }
        },
        "optional_is_init": false,
        "option_root_id": null,
        "option_appui_id": null
    },
    "constants": null,
    "summary": "",
    "description": "",
    "description_parts": []
}